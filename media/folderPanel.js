"use strict";(()=>{function m(e,n,t,o="text"){let r=`<input type="${o}" id="${e}" placeholder="${n}" />`;return t?`<span class="auth-input-wrap">${r}</span>`:r}function oe(e,n){let{prefix:t,fieldsContainer:o,onChange:r,wrapInputs:s,showTokenStatus:a}=n;if(o.innerHTML="",e==="bearer")o.innerHTML=`<div class="auth-row"><label>Token</label>${m(t+"Token","{{token}}",s)}</div>`;else if(e==="basic")o.innerHTML=`<div class="auth-row"><label>Username</label>${m(t+"Username","username",s)}</div><div class="auth-row"><label>Password</label>${m(t+"Password","password",s,"password")}</div>`;else if(e==="apikey")o.innerHTML=`<div class="auth-row"><label>Key</label>${m(t+"Key","X-Api-Key",s)}</div><div class="auth-row"><label>Value</label>${m(t+"Value","{{apiKey}}",s)}</div><div class="auth-row"><label>In</label><select id="${t}Placement" class="auth-select"><option value="header">Header</option><option value="query">Query</option></select></div>`;else if(e==="oauth2"){o.innerHTML=`<div class="auth-row"><label>Grant Type</label><select id="${t}OAuth2Flow" class="auth-select"><option value="client_credentials">Client Credentials</option><option value="password">Password</option><option value="authorization_code">Authorization Code</option></select></div><div class="auth-row"><label>Access Token URL</label>${m(t+"OAuth2AccessTokenUrl","{{authUrl}}/token",s)}</div><div class="auth-row"><label>Client ID</label>${m(t+"OAuth2ClientId","{{clientId}}",s)}</div><div class="auth-row"><label>Client Secret</label>${m(t+"OAuth2ClientSecret","{{clientSecret}}",s)}</div><div class="auth-row"><label>Scope</label>${m(t+"OAuth2Scope","openid profile",s)}</div><div id="${t}OAuth2PasswordFields" style="display:none;"><div class="auth-row"><label>Username</label>${m(t+"OAuth2Username","{{username}}",s)}</div><div class="auth-row"><label>Password</label>${m(t+"OAuth2Password","password",s,"password")}</div></div><div id="${t}OAuth2AuthCodeFields" style="display:none;"><div class="auth-row"><label>Auth URL</label>${m(t+"OAuth2AuthorizationUrl","{{authUrl}}/authorize",s)}</div><div class="auth-row"><label>Callback URL</label>${m(t+"OAuth2CallbackUrl","https://localhost/callback",s)}</div></div><div class="auth-row"><label>Refresh URL</label>${m(t+"OAuth2RefreshTokenUrl","(optional)",s)}</div><div class="auth-row"><label>Credentials In</label><select id="${t}OAuth2CredentialsPlacement" class="auth-select"><option value="basic_auth_header">Header</option><option value="body">Body</option></select></div><div class="auth-row"><label>Auto Fetch</label><input type="checkbox" id="${t}OAuth2AutoFetch" checked /></div><div class="auth-row"><label>Auto Refresh</label><input type="checkbox" id="${t}OAuth2AutoRefresh" checked /></div>`+(a?`<div class="oauth2-token-status" id="${t}OAuth2TokenStatus"></div>`:"");let l=document.getElementById(t+"OAuth2Flow"),i=document.getElementById(t+"OAuth2PasswordFields"),c=document.getElementById(t+"OAuth2AuthCodeFields"),d=()=>{let u=l.value;i.style.display=u==="password"?"":"none",c.style.display=u==="authorization_code"?"":"none"};l.addEventListener("change",()=>{d(),r()}),d()}if(o.querySelectorAll("input").forEach(l=>{l.addEventListener("input",r),l.addEventListener("change",r)}),o.querySelectorAll("select").forEach(l=>l.addEventListener("change",r)),n.onFieldsRendered){let l=Array.from(o.querySelectorAll('input[type="text"]'));n.onFieldsRendered(l)}}function U(e,n){let t=n,o=s=>document.getElementById(s),r=s=>document.getElementById(s);switch(e){case"bearer":return{type:"bearer",token:o(t+"Token")?.value||""};case"basic":return{type:"basic",username:o(t+"Username")?.value||"",password:o(t+"Password")?.value||""};case"apikey":return{type:"apikey",key:o(t+"Key")?.value||"",value:o(t+"Value")?.value||"",placement:r(t+"Placement")?.value||"header"};case"oauth2":{let s=r(t+"OAuth2Flow")?.value||"client_credentials",a={type:"oauth2",flow:s,accessTokenUrl:o(t+"OAuth2AccessTokenUrl")?.value||"",clientId:o(t+"OAuth2ClientId")?.value||"",clientSecret:o(t+"OAuth2ClientSecret")?.value||"",scope:o(t+"OAuth2Scope")?.value||"",refreshTokenUrl:o(t+"OAuth2RefreshTokenUrl")?.value||"",credentialsPlacement:r(t+"OAuth2CredentialsPlacement")?.value||"basic_auth_header",autoFetchToken:o(t+"OAuth2AutoFetch")?.checked!==!1,autoRefreshToken:o(t+"OAuth2AutoRefresh")?.checked!==!1};return s==="password"?(a.username=o(t+"OAuth2Username")?.value||"",a.password=o(t+"OAuth2Password")?.value||""):s==="authorization_code"&&(a.authorizationUrl=o(t+"OAuth2AuthorizationUrl")?.value||"",a.callbackUrl=o(t+"OAuth2CallbackUrl")?.value||""),a.refreshTokenUrl||delete a.refreshTokenUrl,a.scope||delete a.scope,a.clientSecret||delete a.clientSecret,a}case"inherit":return"inherit";default:return}}function re(e,n){let t=n,o=s=>document.getElementById(s),r=s=>document.getElementById(s);if(!(!e||e==="inherit")&&!(typeof e!="object"||!e.type))switch(e.type){case"bearer":{let s=o(t+"Token");s&&(s.value=e.token||"");break}case"basic":{let s=o(t+"Username");s&&(s.value=e.username||"");let a=o(t+"Password");a&&(a.value=e.password||"");break}case"apikey":{let s=o(t+"Key");s&&(s.value=e.key||"");let a=o(t+"Value");a&&(a.value=e.value||"");let l=r(t+"Placement");l&&(l.value=e.placement||"header");break}case"oauth2":{let s=r(t+"OAuth2Flow");s&&(s.value=e.flow||"client_credentials",s.dispatchEvent(new Event("change")));let a=o(t+"OAuth2AccessTokenUrl");a&&(a.value=e.accessTokenUrl||"");let l=o(t+"OAuth2ClientId");l&&(l.value=e.clientId||"");let i=o(t+"OAuth2ClientSecret");i&&(i.value=e.clientSecret||"");let c=o(t+"OAuth2Scope");c&&(c.value=e.scope||"");let d=o(t+"OAuth2RefreshTokenUrl");d&&(d.value=e.refreshTokenUrl||"");let u=r(t+"OAuth2CredentialsPlacement");u&&(u.value=e.credentialsPlacement||"basic_auth_header");let f=o(t+"OAuth2AutoFetch");f&&(f.checked=e.autoFetchToken!==!1);let g=o(t+"OAuth2AutoRefresh");if(g&&(g.checked=e.autoRefreshToken!==!1),e.flow==="password"){let h=o(t+"OAuth2Username");h&&(h.value=e.username||"");let E=o(t+"OAuth2Password");E&&(E.value=e.password||"")}else if(e.flow==="authorization_code"){let h=o(t+"OAuth2AuthorizationUrl");h&&(h.value=e.authorizationUrl||"");let E=o(t+"OAuth2CallbackUrl");E&&(E.value=e.callbackUrl||"")}break}}}function Oe(e){if(e<=0)return"expired";let n=Math.floor(e/1e3);if(n<60)return`${n}s`;let t=Math.floor(n/60);return t<60?`${t}m ${n%60}s`:`${Math.floor(t/60)}h ${t%60}m`}function ae(e){let n=`${e.prefix}OAuth2TokenStatus`,t=null,o=null;function r(){return document.getElementById(n)}function s(){t&&(clearInterval(t),t=null)}function a(){let u=e.buildAuth();!u||u.type!=="oauth2"||!u.accessTokenUrl||e.postMessage({type:"getTokenStatus",auth:u})}function l(u){let f=r();if(!f)return;if(!u?.hasToken){f.innerHTML=`<div class="token-status token-none"><span class="token-dot dot-none"></span> No token<button class="token-btn" id="${n}-get">Get Token</button></div>`,f.querySelector(`#${n}-get`)?.addEventListener("click",()=>{let q=e.buildAuth();e.postMessage({type:"getToken",auth:q})});return}let g=Date.now(),h=u.expiresAt?u.expiresAt-g:void 0,E=h!==void 0&&h<=0,Re=E?"dot-expired":"dot-valid",Me=E?"Expired":h!==void 0?`Expires in ${Oe(h)}`:"Valid (no expiry)",se=u.expiresAt?new Date(u.expiresAt).toLocaleTimeString():"";f.innerHTML='<div class="token-status '+(E?"token-expired":"token-valid")+'"><span class="token-dot '+Re+'"></span> '+Me+(se?'<span class="token-expiry-time"> ('+e.esc(se)+")</span>":"")+`<button class="token-btn" id="${n}-refresh">${E?"Get Token":"Refresh"}</button></div>`,f.querySelector(`#${n}-refresh`)?.addEventListener("click",()=>{let q=e.buildAuth();e.postMessage({type:"getToken",auth:q})})}function i(u){o=u,s(),l(u),u?.expiresAt&&(t=setInterval(()=>{l(o),o?.expiresAt&&Date.now()>o.expiresAt&&s()},1e3))}function c(u){let f=r();if(!f||!u)return;s();let g=u.startsWith("Error:");f.innerHTML='<div class="token-status '+(g?"token-error":"token-progress")+'">'+(g?'<span class="token-dot dot-expired"></span> ':'<span class="token-spinner"></span> ')+e.esc(u)+"</div>"}function d(){s()}return{requestStatus:a,handleStatus:i,handleProgress:c,dispose:d}}var Ie=/\{\{(\s*[\w.$-]+\s*)\}\}/g,le=/^[\w.$-]*$/;function y(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var Ve=new Set(["$guid","$timestamp","$randomInt"]);function ie(e,n){return e.replace(Ie,(t,o)=>{let r=o.trim(),s=r in n.resolved,a=Ve.has(r),l=n.secretKeys?.has(r)??!1,i=s||a||l,c=n.sources[r]||(l?"secret":a?"dynamic":"unknown");return n.showResolved&&s?"<span class='"+("tk-var-resolved tk-src-"+c)+"' data-var='"+y(r)+"' title='{{"+y(r)+"}} ("+c+")'>"+y(n.resolved[r])+"</span>":"<span class='"+(i?"tk-var tk-src-"+c:"tk-var tk-var-unresolved")+"' data-var='"+y(r)+"'>{{"+y(o)+"}}</span>"})}var S=null;function M(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}function ce(e){S&&!S.contains(e.target)&&_()}function _(){S&&(S.remove(),S=null),document.removeEventListener("click",ce)}function P(e,n,t){_();let o=e.getBoundingClientRect(),r=t.getResolvedVariables(),s=t.getVariableSources(),a=n in r,l=s[n]||"unknown",i=l.charAt(0).toUpperCase()+l.slice(1),c=document.createElement("div");c.className="var-tooltip";let d=[];t.onEditVariable&&d.push("<button class='var-action-btn' data-action='edit'>Edit</button>"),d.push("<button class='var-action-btn' data-action='copy'>"+(a?"Copy Value":"Copy Name")+"</button>"),c.innerHTML="<div class='var-name'>{{"+M(n)+"}}</div>"+(a?"<div class='var-source tk-src-"+M(l)+"'>"+M(i)+"</div><div class='var-value'>"+M(r[n])+"</div>":"<div class='var-unresolved'>Unresolved variable</div>")+"<div class='var-actions'>"+d.join("")+"</div>",c.style.left=o.left+"px",c.style.top=o.bottom+4+"px",document.body.appendChild(c),S=c,c.querySelectorAll(".var-action-btn").forEach(u=>{u.addEventListener("click",()=>{let f=u.dataset.action;if(f==="edit"&&t.onEditVariable)t.onEditVariable(n);else if(f==="copy"){let g=a?r[n]:"{{"+n+"}}";navigator.clipboard.writeText(g).catch(()=>{})}_()})}),setTimeout(()=>{document.addEventListener("click",ce)},0)}var ue=()=>({});function de(e){ue=e}var v=null,T=[],x=0,C=null,A=0,O=!1,N=null,$e=[{name:"$guid",detail:"Generate a random UUID"},{name:"$timestamp",detail:"Current Unix timestamp"},{name:"$randomInt",detail:"Random integer 0\u20131000"}],F=[],pe=new Map;function fe(e){F=e}function ve(e,n){pe.set(e,n)}function he(e,n){let t=e.substring(0,n),o=t.lastIndexOf("{{");if(o===-1)return null;let r=t.substring(o+2);if(r.includes("}}"))return null;let s=r.trim();return le.test(s)?s:null}function D(e,n){let t=e.selectionStart??0,o=he(e.value,t);if(o===null){w();return}C=e,O=!1,A=e.value.lastIndexOf("{{",t-1),ge(o,e,n)}function K(e,n){let t=window.getSelection();if(!t||t.rangeCount===0)return;let o=e.textContent||"",r=t.getRangeAt(0),s=document.createRange();s.selectNodeContents(e),s.setEnd(r.startContainer,r.startOffset);let a=s.toString().length,l=he(o,a);if(l===null){w();return}C=e,O=!0,A=o.lastIndexOf("{{",a-1),ge(l,e,n)}function ge(e,n,t){N=t;let o=e.toLowerCase(),r=[],s=ue();for(let l of Object.keys(s))r.push({name:l,detail:s[l]});for(let l of $e)r.push(l);if(o===""||"$secret".startsWith(o))F.length>0&&r.push({name:"$secret",detail:"Secret provider"});else if(o.startsWith("$secret.")){let l=o.substring(8),i=l.indexOf(".");if(i===-1)for(let c of F)c.toLowerCase().startsWith(l)&&r.push({name:"$secret."+c,detail:"Key Vault provider"});else{let c=l.substring(0,i),d=l.substring(i+1),u=pe.get(c)||[];for(let f of u)f.toLowerCase().startsWith(d)&&r.push({name:"$secret."+c+"."+f,displayName:f,detail:"Secret"})}}let a=new Set;T=[];for(let l of r)l.name.toLowerCase().startsWith(o)&&!a.has(l.name)&&(a.add(l.name),T.push(l));if(T.length===0){w();return}x=0,v||(v=document.createElement("div"),v.className="var-autocomplete",document.body.appendChild(v)),B(),Ue(n)}function B(){v&&(v.innerHTML=T.map((e,n)=>"<div class='"+(n===x?"var-autocomplete-item selected":"var-autocomplete-item")+"' data-index='"+n+"'><span class='var-ac-name'>"+y(e.displayName||e.name)+"</span><span class='var-ac-value'>"+y(e.detail||"")+"</span></div>").join(""),v.querySelectorAll(".var-autocomplete-item").forEach(e=>{e.addEventListener("mousedown",n=>{n.preventDefault();let t=parseInt(e.dataset.index||"0");Ee(T[t].name)})}))}function qe(e){let n=document.createElement("div"),t=window.getComputedStyle(e);["fontFamily","fontSize","fontWeight","letterSpacing","lineHeight","paddingTop","paddingLeft","paddingRight","paddingBottom","borderWidth","boxSizing","whiteSpace","wordWrap","overflowWrap","tabSize"].forEach(c=>{n.style[c]=t.getPropertyValue(c.replace(/[A-Z]/g,d=>"-"+d.toLowerCase()))}),n.style.position="absolute",n.style.visibility="hidden",n.style.whiteSpace="pre-wrap",n.style.wordWrap="break-word",n.style.width=e.clientWidth+"px";let r=e.value.substring(0,e.selectionStart??0);n.textContent=r;let s=document.createElement("span");s.textContent="|",n.appendChild(s),document.body.appendChild(n);let a=s.getBoundingClientRect(),l=e.getBoundingClientRect(),i={top:l.top+(a.top-n.getBoundingClientRect().top)-e.scrollTop,left:l.left+(a.left-n.getBoundingClientRect().left)-e.scrollLeft};return document.body.removeChild(n),i}function Ue(e){if(v){if(O){let n=window.getSelection();if(n&&n.rangeCount>0){let o=n.getRangeAt(0).getBoundingClientRect();v.style.left=o.left+"px",v.style.top=o.bottom+4+"px"}else{let t=e.getBoundingClientRect();v.style.left=t.left+"px",v.style.top=t.bottom+2+"px"}}else{let n=qe(e);v.style.left=n.left+"px",v.style.top=n.top+18+"px"}v.style.minWidth="220px"}}var me=null,ye=null,be=null,L=null;function Te(e,n,t,o){me=e,ye=n,be=t,L=o||null}function _e(e){return!!(e==="$secret"||e.startsWith("$secret.")&&e.split(".").length===2)}function Ee(e){if(!C)return;let n=_e(e),t=C,o=O,r=N;if(o){let s=t,a=s,l=a._getRawText?a._getRawText():s.textContent||"",i=window.getSelection(),c=l.length;if(i&&i.rangeCount>0){let f=i.getRangeAt(0),g=document.createRange();g.selectNodeContents(s),g.setEnd(f.startContainer,f.startOffset),c=g.toString().length}let d,u;if(n){d="{{"+e+".";let f=c;l.substring(c).startsWith("}}")&&(f+=2);let h=l.substring(0,A)+d+l.substring(f);u=A+d.length,a._setRawText?a._setRawText(h):L&&L(h)}else{d="{{"+e+"}}";let f=c;l.substring(c).startsWith("}}")&&(f+=2);let h=l.substring(0,A)+d+l.substring(f);u=A+d.length,a._setRawText?a._setRawText(h):L&&L(h)}if(r?r():ye?.(),be?.(s,u),n){w(),setTimeout(()=>{K(s,r||(()=>{}))},0);return}}else{let s=t,a=s.value,l=s.selectionStart??a.length,i,c;if(n){i="{{"+e+".";let d=l;a.substring(l).startsWith("}}")&&(d+=2),s.value=a.substring(0,A)+i+a.substring(d),c=A+i.length}else{i="{{"+e+"}}";let d=l;a.substring(l).startsWith("}}")&&(d+=2),s.value=a.substring(0,A)+i+a.substring(d),c=A+i.length}if(s.selectionStart=c,s.selectionEnd=c,s.focus(),r?r():me?.(),n){w(),setTimeout(()=>{D(s,r||(()=>{}))},0);return}}w()}function w(){v&&(v.remove(),v=null),C=null,T=[],x=0,N=null}function W(e){return!v||T.length===0?!1:e.key==="ArrowDown"?(e.preventDefault(),x=(x+1)%T.length,B(),!0):e.key==="ArrowUp"?(e.preventDefault(),x=(x-1+T.length)%T.length,B(),!0):e.key==="Enter"||e.key==="Tab"?(e.preventDefault(),Ee(T[x].name),!0):e.key==="Escape"?(e.preventDefault(),w(),!0):!1}function z(){return v!==null}var R={},V={},H=!1,Ae=new Set,Pe=null;function G(){return H}function we(e){H=e}function I(e){return ie(e,{resolved:R,sources:V,showResolved:H,secretKeys:Ae})}function j(e,n){let t=window.getSelection();if(!t)return;let o=document.createRange(),r=0,s=!1;function a(l){if(l.nodeType===Node.TEXT_NODE){let i=(l.textContent||"").length;if(r+i>=n)return o.setStart(l,n-r),o.collapse(!0),!0;r+=i}else for(let i=0;i<l.childNodes.length;i++)if(a(l.childNodes[i]))return!0;return!1}s=a(e),s||(o.selectNodeContents(e),o.collapse(!1)),t.removeAllRanges(),t.addRange(o)}function k(){document.querySelectorAll(".var-cell").forEach(e=>{let n=e.querySelector('input[type="text"]'),t=e.querySelector(".var-overlay");n&&t&&e.classList.contains("var-overlay-active")&&(t.innerHTML=I(y(n.value)))}),document.querySelectorAll(".val-ce").forEach(e=>{let n=e._getRawText;if(n&&document.activeElement!==e){let t=n();t&&(e.innerHTML=I(y(t)))}})}function xe(e){let n=e.parentElement;n.classList.add("var-cell");let t=document.createElement("div");t.className="var-overlay",n.appendChild(t);function o(){t.innerHTML=I(y(e.value))}function r(){n.classList.add("var-overlay-active"),o()}function s(){n.classList.remove("var-overlay-active")}e.addEventListener("input",()=>{o(),D(e,o)}),e.addEventListener("focus",s),e.addEventListener("blur",()=>{r(),w()}),e.addEventListener("keydown",a=>{z()&&W(a)}),t.addEventListener("click",a=>{let l=a.target.closest(".tk-var, .tk-var-resolved");l&&l.dataset.var?P(l,l.dataset.var,{getResolvedVariables:()=>R,getVariableSources:()=>V}):(s(),e.focus())}),document.activeElement!==e&&r()}function X(e,n,t){let o=n||"";e._getRawText=()=>o,e._setRawText=s=>{o=s};function r(){if(!o){e.innerHTML="";return}let s=window.getSelection(),a=0;if(s&&s.rangeCount>0&&e.contains(s.anchorNode)){let l=s.getRangeAt(0),i=document.createRange();i.selectNodeContents(e),i.setEnd(l.startContainer,l.startOffset),a=i.toString().length}e.innerHTML=I(y(o)),s&&document.activeElement===e&&j(e,a)}r(),e.addEventListener("input",()=>{if(H){H=!1,k(),Pe?.();return}let s=window.getSelection(),a=0;if(s&&s.rangeCount>0&&e.contains(s.anchorNode)){let l=s.getRangeAt(0),i=document.createRange();i.selectNodeContents(e),i.setEnd(l.startContainer,l.startOffset),a=i.toString().length}o=e.textContent||"",r(),j(e,a),t(),K(e,r)}),e.addEventListener("keydown",s=>{z()&&W(s)}),e.addEventListener("blur",()=>{w()}),e.addEventListener("click",s=>{let a=s.target.closest(".tk-var, .tk-var-resolved");a&&a.dataset.var&&P(a,a.dataset.var,{getResolvedVariables:()=>R,getVariableSources:()=>V})})}function Se(e){if(e.type!=="variablesResolved")return!1;R=e.variables||{},V=e.sources||{},fe(e.secretProviderNames||[]);let n=e.secretNames||{},t=new Set;for(let[o,r]of Object.entries(n)){ve(o,r);for(let s of r)t.add(`$secret.${o}.${s}`)}return Ae=t,k(),!0}function ke(e){de(()=>R),Te(()=>{k(),e?.extraSyncHighlight?.()},()=>{k(),e?.extraSyncUrlHighlight?.()},j,e?.setRawUrl)}var Y=acquireVsCodeApi(),ee=null,Q=!1,Z=!1,J=null;function p(e){return document.getElementById(e)}function te(e){if(!e)return"";let n=document.createElement("div");return n.textContent=e,n.innerHTML}function b(){Z||(J&&clearTimeout(J),J=setTimeout(()=>{ee&&Fe()},400))}function Fe(){let e=JSON.parse(JSON.stringify(ee));e.info=e.info||{},e.info.type="folder",e.info.name=p("infoName").value||void 0;let n=p("infoDescription").value;n?e.info.description=n:delete e.info.description;let t=[];document.querySelectorAll("#defaultHeadersBody tr").forEach(a=>{let l=a.querySelector('input[type="text"]'),i=a.querySelector(".val-ce"),c=a.querySelector('input[type="checkbox"]');if(l?.value){let d={name:l.value,value:i?._getRawText?i._getRawText():i?.textContent||""};c&&!c.checked&&(d.disabled=!0),t.push(d)}}),e.request||(e.request={}),e.request.headers=t.length>0?t:void 0;let o=p("defaultAuthType").value,r=U(o,"dAuth");r!==void 0?e.request.auth=r:delete e.request.auth;let s=[];document.querySelectorAll("#defaultVarsBody tr").forEach(a=>{let l=a.querySelector('input[type="text"]'),i=a.querySelector(".val-ce"),c=a.querySelector('input[type="checkbox"]');if(l?.value){let d={name:l.value,value:i?._getRawText?i._getRawText():i?.textContent||""};c&&!c.checked&&(d.disabled=!0),s.push(d)}}),e.request=e.request||{},e.request.variables=s.length>0?s:void 0,e.request&&Object.keys(e.request).every(a=>e.request[a]===void 0)&&delete e.request,Q=!0,Y.postMessage({type:"updateDocument",folder:e})}function Be(e){let n=p(e);n&&n.querySelectorAll(".tab").forEach(t=>{t.addEventListener("click",()=>{let o=t.dataset.tab;n.querySelectorAll(".tab").forEach(a=>a.classList.remove("active")),t.classList.add("active");let r=n.parentElement;r.querySelectorAll(":scope > .tab-content > .tab-panel").forEach(a=>a.classList.remove("active"));let s=r.querySelector(`#panel-${o}`);s&&s.classList.add("active")})})}function Ne(e){let n=p("defaultHeadersBody");n.innerHTML="",(e||[]).forEach(t=>Le(t.name,t.value,t.disabled))}function Le(e,n,t){let o=p("defaultHeadersBody"),r=document.createElement("tr");r.innerHTML=`<td><input type="checkbox" ${t?"":"checked"} /></td><td><input type="text" value="${te(e||"")}" placeholder="Header name" /></td><td class="val-cell"><div class="val-ce" contenteditable="true" data-placeholder="Header value"></div></td><td><button class="row-delete">\xD7</button></td>`,r.querySelector(".row-delete").addEventListener("click",()=>{r.remove(),b()}),r.querySelector('input[type="text"]').addEventListener("input",b),r.querySelector('input[type="checkbox"]').addEventListener("change",b),X(r.querySelector(".val-ce"),n||"",b),o.appendChild(r)}function De(e){let n=p("defaultVarsBody");n.innerHTML="",(e||[]).forEach(t=>Ce(t.name,t.value,t.disabled))}function Ce(e,n,t){let o=p("defaultVarsBody"),r=document.createElement("tr"),s=typeof n=="string"?n:n&&n.data?n.data:"";r.innerHTML=`<td><input type="checkbox" ${t?"":"checked"} /></td><td><input type="text" value="${te(e||"")}" placeholder="Variable name" /></td><td class="val-cell"><div class="val-ce" contenteditable="true" data-placeholder="Variable value"></div></td><td><button class="row-delete">\xD7</button></td>`,r.querySelector(".row-delete").addEventListener("click",()=>{r.remove(),b()}),r.querySelector('input[type="text"]').addEventListener("input",b),r.querySelector('input[type="checkbox"]').addEventListener("change",b),X(r.querySelector(".val-ce"),s,b),o.appendChild(r)}var Ke={prefix:"dAuth",get fieldsContainer(){return p("defaultAuthFields")},onChange:()=>b(),showInherit:!0,wrapInputs:!0,showTokenStatus:!0,onFieldsRendered:e=>e.forEach(n=>xe(n))},$=ae({prefix:"dAuth",buildAuth:()=>U(p("defaultAuthType").value,"dAuth"),postMessage:e=>Y.postMessage(e),esc:te});function He(){let e=p("defaultAuthType").value;oe(e,Ke),e==="oauth2"&&$.requestStatus()}function ne(){p("headersBadge").textContent=String(document.querySelectorAll("#defaultHeadersBody tr").length),p("variablesBadge").textContent=String(document.querySelectorAll("#defaultVarsBody tr").length)}function We(e){Z=!0,ee=e,p("infoName").value=e.info?.name||"";let n=e.info?.description;p("infoDescription").value=typeof n=="string"?n:n?.content||"",p("folderName").textContent=e.info?.name||"Folder";let t=e.request?.auth;t==="inherit"?p("defaultAuthType").value="inherit":t?.type?p("defaultAuthType").value=t.type:p("defaultAuthType").value="none",He(),t&&t!=="inherit"&&t.type&&re(t,"dAuth"),Ne(e.request?.headers||[]),De(e.request?.variables||[]),ne(),Z=!1}ke();Be("mainTabs");p("defaultAuthType").addEventListener("change",He);p("addDefaultHeaderBtn").addEventListener("click",()=>{Le(),ne(),b()});p("addDefaultVarBtn").addEventListener("click",()=>{Ce(),ne(),b()});p("varToggleBtn").addEventListener("click",()=>{we(!G()),p("varToggleBtn").classList.toggle("active",G()),k()});p("infoName").addEventListener("input",()=>{p("folderName").textContent=p("infoName").value||"Folder",b()});p("infoDescription").addEventListener("input",b);window.addEventListener("message",e=>{let n=e.data;if(n.type==="folderLoaded"){if(Q){Q=!1;return}We(n.folder)}Se(n)&&$.requestStatus(),n.type==="oauth2TokenStatus"&&$.handleStatus(n.status),n.type==="oauth2Progress"&&$.handleProgress(n.message)});Y.postMessage({type:"ready"});})();

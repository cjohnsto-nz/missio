"use strict";(()=>{function y(e,n,t,o="text"){let r=`<input type="${o}" id="${e}" placeholder="${n}" />`;return t?`<span class="auth-input-wrap">${r}</span>`:r}function de(e,n){let{prefix:t,fieldsContainer:o,onChange:r,wrapInputs:s,showTokenStatus:a}=n;if(o.innerHTML="",e==="bearer")o.innerHTML=`<div class="auth-row"><label>Token</label>${y(t+"Token","{{token}}",s)}</div>`;else if(e==="basic")o.innerHTML=`<div class="auth-row"><label>Username</label>${y(t+"Username","username",s)}</div><div class="auth-row"><label>Password</label>${y(t+"Password","password",s,"password")}</div>`;else if(e==="apikey")o.innerHTML=`<div class="auth-row"><label>Key</label>${y(t+"Key","X-Api-Key",s)}</div><div class="auth-row"><label>Value</label>${y(t+"Value","{{apiKey}}",s)}</div><div class="auth-row"><label>In</label><select id="${t}Placement" class="auth-select"><option value="header">Header</option><option value="query">Query</option></select></div>`;else if(e==="oauth2"){o.innerHTML=`<div class="auth-row"><label>Grant Type</label><select id="${t}OAuth2Flow" class="auth-select"><option value="client_credentials">Client Credentials</option><option value="password">Password</option><option value="authorization_code">Authorization Code</option></select></div><div class="auth-row"><label>Access Token URL</label>${y(t+"OAuth2AccessTokenUrl","{{authUrl}}/token",s)}</div><div class="auth-row"><label>Client ID</label>${y(t+"OAuth2ClientId","{{clientId}}",s)}</div><div class="auth-row"><label>Client Secret</label>${y(t+"OAuth2ClientSecret","{{clientSecret}}",s)}</div><div class="auth-row"><label>Scope</label>${y(t+"OAuth2Scope","openid profile",s)}</div><div id="${t}OAuth2PasswordFields" style="display:none;"><div class="auth-row"><label>Username</label>${y(t+"OAuth2Username","{{username}}",s)}</div><div class="auth-row"><label>Password</label>${y(t+"OAuth2Password","password",s,"password")}</div></div><div id="${t}OAuth2AuthCodeFields" style="display:none;"><div class="auth-row"><label>Auth URL</label>${y(t+"OAuth2AuthorizationUrl","{{authUrl}}/authorize",s)}</div><div class="auth-row"><label>Callback URL</label>${y(t+"OAuth2CallbackUrl","https://localhost/callback",s)}</div></div><div class="auth-row"><label>Refresh URL</label>${y(t+"OAuth2RefreshTokenUrl","(optional)",s)}</div><div class="auth-row"><label>Credentials In</label><select id="${t}OAuth2CredentialsPlacement" class="auth-select"><option value="basic_auth_header">Header</option><option value="body">Body</option></select></div><div class="auth-row"><label>Auto Fetch</label><input type="checkbox" id="${t}OAuth2AutoFetch" checked /></div><div class="auth-row"><label>Auto Refresh</label><input type="checkbox" id="${t}OAuth2AutoRefresh" checked /></div>`+(a?`<div class="oauth2-token-status" id="${t}OAuth2TokenStatus"></div>`:"");let l=document.getElementById(t+"OAuth2Flow"),i=document.getElementById(t+"OAuth2PasswordFields"),c=document.getElementById(t+"OAuth2AuthCodeFields"),d=()=>{let u=l.value;i.style.display=u==="password"?"":"none",c.style.display=u==="authorization_code"?"":"none"};l.addEventListener("change",()=>{d(),r()}),d()}if(o.querySelectorAll("input").forEach(l=>{l.addEventListener("input",r),l.addEventListener("change",r)}),o.querySelectorAll("select").forEach(l=>l.addEventListener("change",r)),n.onFieldsRendered){let l=Array.from(o.querySelectorAll('input[type="text"]'));n.onFieldsRendered(l)}}function G(e,n){let t=n,o=s=>document.getElementById(s),r=s=>document.getElementById(s);switch(e){case"bearer":return{type:"bearer",token:o(t+"Token")?.value||""};case"basic":return{type:"basic",username:o(t+"Username")?.value||"",password:o(t+"Password")?.value||""};case"apikey":return{type:"apikey",key:o(t+"Key")?.value||"",value:o(t+"Value")?.value||"",placement:r(t+"Placement")?.value||"header"};case"oauth2":{let s=r(t+"OAuth2Flow")?.value||"client_credentials",a={type:"oauth2",flow:s,accessTokenUrl:o(t+"OAuth2AccessTokenUrl")?.value||"",clientId:o(t+"OAuth2ClientId")?.value||"",clientSecret:o(t+"OAuth2ClientSecret")?.value||"",scope:o(t+"OAuth2Scope")?.value||"",refreshTokenUrl:o(t+"OAuth2RefreshTokenUrl")?.value||"",credentialsPlacement:r(t+"OAuth2CredentialsPlacement")?.value||"basic_auth_header",autoFetchToken:o(t+"OAuth2AutoFetch")?.checked!==!1,autoRefreshToken:o(t+"OAuth2AutoRefresh")?.checked!==!1};return s==="password"?(a.username=o(t+"OAuth2Username")?.value||"",a.password=o(t+"OAuth2Password")?.value||""):s==="authorization_code"&&(a.authorizationUrl=o(t+"OAuth2AuthorizationUrl")?.value||"",a.callbackUrl=o(t+"OAuth2CallbackUrl")?.value||""),a.refreshTokenUrl||delete a.refreshTokenUrl,a.scope||delete a.scope,a.clientSecret||delete a.clientSecret,a}case"inherit":return"inherit";default:return}}function pe(e,n){let t=n,o=s=>document.getElementById(s),r=s=>document.getElementById(s);if(!(!e||e==="inherit")&&!(typeof e!="object"||!e.type))switch(e.type){case"bearer":{let s=o(t+"Token");s&&(s.value=e.token||"");break}case"basic":{let s=o(t+"Username");s&&(s.value=e.username||"");let a=o(t+"Password");a&&(a.value=e.password||"");break}case"apikey":{let s=o(t+"Key");s&&(s.value=e.key||"");let a=o(t+"Value");a&&(a.value=e.value||"");let l=r(t+"Placement");l&&(l.value=e.placement||"header");break}case"oauth2":{let s=r(t+"OAuth2Flow");s&&(s.value=e.flow||"client_credentials",s.dispatchEvent(new Event("change")));let a=o(t+"OAuth2AccessTokenUrl");a&&(a.value=e.accessTokenUrl||"");let l=o(t+"OAuth2ClientId");l&&(l.value=e.clientId||"");let i=o(t+"OAuth2ClientSecret");i&&(i.value=e.clientSecret||"");let c=o(t+"OAuth2Scope");c&&(c.value=e.scope||"");let d=o(t+"OAuth2RefreshTokenUrl");d&&(d.value=e.refreshTokenUrl||"");let u=r(t+"OAuth2CredentialsPlacement");u&&(u.value=e.credentialsPlacement||"basic_auth_header");let p=o(t+"OAuth2AutoFetch");p&&(p.checked=e.autoFetchToken!==!1);let h=o(t+"OAuth2AutoRefresh");if(h&&(h.checked=e.autoRefreshToken!==!1),e.flow==="password"){let v=o(t+"OAuth2Username");v&&(v.value=e.username||"");let m=o(t+"OAuth2Password");m&&(m.value=e.password||"")}else if(e.flow==="authorization_code"){let v=o(t+"OAuth2AuthorizationUrl");v&&(v.value=e.authorizationUrl||"");let m=o(t+"OAuth2CallbackUrl");m&&(m.value=e.callbackUrl||"")}break}}}function Be(e){if(e<=0)return"expired";let n=Math.floor(e/1e3);if(n<60)return`${n}s`;let t=Math.floor(n/60);return t<60?`${t}m ${n%60}s`:`${Math.floor(t/60)}h ${t%60}m`}function fe(e){let n=`${e.prefix}OAuth2TokenStatus`,t=null,o=null;function r(){return document.getElementById(n)}function s(){t&&(clearInterval(t),t=null)}function a(){let u=e.buildAuth();!u||u.type!=="oauth2"||!u.accessTokenUrl||e.postMessage({type:"getTokenStatus",auth:u})}function l(u){let p=r();if(!p)return;if(!u?.hasToken){p.innerHTML=`<div class="token-status token-none"><span class="token-dot dot-none"></span> No token<button class="token-btn" id="${n}-get">Get Token</button></div>`,p.querySelector(`#${n}-get`)?.addEventListener("click",()=>{let M=e.buildAuth();e.postMessage({type:"getToken",auth:M})});return}let h=Date.now(),v=u.expiresAt?u.expiresAt-h:void 0,m=v!==void 0&&v<=0,j=m?"dot-expired":"dot-valid",R=m?"Expired":v!==void 0?`Expires in ${Be(v)}`:"Valid (no expiry)",E=u.expiresAt?new Date(u.expiresAt).toLocaleTimeString():"";p.innerHTML='<div class="token-status '+(m?"token-expired":"token-valid")+'"><span class="token-dot '+j+'"></span> '+R+(E?'<span class="token-expiry-time"> ('+e.esc(E)+")</span>":"")+`<button class="token-btn" id="${n}-refresh">${m?"Get Token":"Refresh"}</button></div>`,p.querySelector(`#${n}-refresh`)?.addEventListener("click",()=>{let M=e.buildAuth();e.postMessage({type:"getToken",auth:M})})}function i(u){o=u,s(),l(u),u?.expiresAt&&(t=setInterval(()=>{l(o),o?.expiresAt&&Date.now()>o.expiresAt&&s()},1e3))}function c(u){let p=r();if(!p||!u)return;s();let h=u.startsWith("Error:");p.innerHTML='<div class="token-status '+(h?"token-error":"token-progress")+'">'+(h?'<span class="token-dot dot-expired"></span> ':'<span class="token-spinner"></span> ')+e.esc(u)+"</div>"}function d(){s()}return{requestStatus:a,handleStatus:i,handleProgress:c,dispose:d}}var Ne=/\{\{(\s*[\w.$-]+\s*)\}\}/g,ve=/^[\w.$-]*$/;function b(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var De=new Set(["$guid","$timestamp","$randomInt"]);function ge(e,n){return e.replace(Ne,(t,o)=>{let r=o.trim(),s=r in n.resolved,a=De.has(r),l=n.secretKeys?.has(r)??!1,i=s||a||l,c=n.sources[r]||(l?"secret":a?"dynamic":"unknown");return n.showResolved&&s?"<span class='"+("tk-var-resolved tk-src-"+c)+"' data-var='"+b(r)+"' title='{{"+b(r)+"}} ("+c+")'>"+b(n.resolved[r])+"</span>":"<span class='"+(i?"tk-var tk-src-"+c:"tk-var tk-var-unresolved")+"' data-var='"+b(r)+"'>{{"+b(o)+"}}</span>"})}var S=null,J=null;function U(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}function he(e){S&&!S.contains(e.target)&&_()}function _(){S&&(S.remove(),S=null),J=null,document.removeEventListener("click",he)}function me(e){if(!S||e.secretRef!==J)return;let n=S.querySelector(".var-secret-value"),t=S.querySelector('.var-action-btn[data-action="reveal"]');if(e.error){n&&(n.textContent=e.error,n.style.color="#f48771",n.style.fontStyle="normal"),t&&(t.textContent="Reveal Value");return}let o=e.value??"";V=o,n&&(n.textContent=o,n.style.cssText=""),t&&(t.textContent="Hide Value"),k=!0;let r=S.querySelector('.var-action-btn[data-action="copy"]');r&&(r.textContent="Copy Value",r.dataset.secretValue=o)}var V=null,k=!1;function X(e,n,t){_(),V=null,k=!1;let o=e.getBoundingClientRect(),r=t.getResolvedVariables(),s=t.getVariableSources(),a=t.getSecretKeys?.()??new Set,l=n in r,i=a.has(n),c=s[n]||(i?"secret":"unknown"),d=c.charAt(0).toUpperCase()+c.slice(1),u=l||i,p=document.createElement("div");p.className="var-tooltip";let h;l?h="<div class='var-source tk-src-"+U(c)+"'>"+U(d)+"</div><div class='var-value'>"+U(r[n])+"</div>":i?h="<div class='var-source tk-src-secret'>Secret</div><div class='var-secret-value var-value' style='font-style:italic;opacity:0.7'>Value hidden</div>":h="<div class='var-unresolved'>Unresolved variable</div>";let v=[];t.onEditVariable&&!i&&v.push("<button class='var-action-btn' data-action='edit'>Edit</button>"),i&&!l&&t.postMessage&&v.push("<button class='var-action-btn' data-action='reveal'>Reveal Value</button>"),v.push("<button class='var-action-btn' data-action='copy'>"+(l?"Copy Value":"Copy Name")+"</button>"),p.innerHTML="<div class='var-name'>{{"+U(n)+"}}</div>"+h+"<div class='var-actions'>"+v.join("")+"</div>",p.style.left=o.left+"px",p.style.top=o.bottom+4+"px",document.body.appendChild(p),S=p,p.querySelectorAll(".var-action-btn").forEach(m=>{m.addEventListener("click",j=>{j.stopPropagation();let R=m.dataset.action;if(R==="edit"&&t.onEditVariable)t.onEditVariable(n),_();else if(R==="copy"){let M=m.dataset.secretValue??(l?r[n]:"{{"+n+"}}");navigator.clipboard.writeText(M).catch(()=>{}),_()}else if(R==="reveal"){let E=p.querySelector(".var-secret-value");V!==null?(k=!k,E&&(k?(E.textContent=V,E.style.cssText=""):(E.textContent="\u2022".repeat(Math.min(V.length,20)),E.style.cssText="")),m.textContent=k?"Hide Value":"Show Value"):(J=n,E&&(E.textContent="Resolving\u2026",E.style.cssText="font-style:italic;opacity:0.7"),m.textContent="Resolving\u2026",t.postMessage({type:"resolveSecret",secretRef:n}))}})}),setTimeout(()=>{document.addEventListener("click",he)},0)}var ye=()=>({});function be(e){ye=e}var g=null,A=[],L=0,I=null,w=0,P=!1,Y=null,Ke=[{name:"$guid",detail:"Generate a random UUID"},{name:"$timestamp",detail:"Current Unix timestamp"},{name:"$randomInt",detail:"Random integer 0\u20131000"}],Q=[],Te=new Map;function Ee(e){Q=e}function Ae(e,n){Te.set(e,n)}function Se(e,n){let t=e.substring(0,n),o=t.lastIndexOf("{{");if(o===-1)return null;let r=t.substring(o+2);if(r.includes("}}"))return null;let s=r.trim();return ve.test(s)?s:null}function ee(e,n){let t=e.selectionStart??0,o=Se(e.value,t);if(o===null){x();return}I=e,P=!1,w=e.value.lastIndexOf("{{",t-1),we(o,e,n)}function te(e,n){let t=window.getSelection();if(!t||t.rangeCount===0)return;let o=e.textContent||"",r=t.getRangeAt(0),s=document.createRange();s.selectNodeContents(e),s.setEnd(r.startContainer,r.startOffset);let a=s.toString().length,l=Se(o,a);if(l===null){x();return}I=e,P=!0,w=o.lastIndexOf("{{",a-1),we(l,e,n)}function we(e,n,t){Y=t;let o=e.toLowerCase(),r=[],s=ye();for(let l of Object.keys(s))r.push({name:l,detail:s[l]});for(let l of Ke)r.push(l);if(o===""||"$secret".startsWith(o))Q.length>0&&r.push({name:"$secret",detail:"Secret provider"});else if(o.startsWith("$secret.")){let l=o.substring(8),i=l.indexOf(".");if(i===-1)for(let c of Q)c.toLowerCase().startsWith(l)&&r.push({name:"$secret."+c,detail:"Key Vault provider"});else{let c=l.substring(0,i),d=l.substring(i+1),u=Te.get(c)||[];for(let p of u)p.toLowerCase().startsWith(d)&&r.push({name:"$secret."+c+"."+p,displayName:p,detail:"Secret"})}}let a=new Set;A=[];for(let l of r)l.name.toLowerCase().startsWith(o)&&!a.has(l.name)&&(a.add(l.name),A.push(l));if(A.length===0){x();return}L=0,g||(g=document.createElement("div"),g.className="var-autocomplete",document.body.appendChild(g)),Z(),ze(n)}function Z(){g&&(g.innerHTML=A.map((e,n)=>"<div class='"+(n===L?"var-autocomplete-item selected":"var-autocomplete-item")+"' data-index='"+n+"'><span class='var-ac-name'>"+b(e.displayName||e.name)+"</span><span class='var-ac-value'>"+b(e.detail||"")+"</span></div>").join(""),g.querySelectorAll(".var-autocomplete-item").forEach(e=>{e.addEventListener("mousedown",n=>{n.preventDefault();let t=parseInt(e.dataset.index||"0");He(A[t].name)})}))}function We(e){let n=document.createElement("div"),t=window.getComputedStyle(e);["fontFamily","fontSize","fontWeight","letterSpacing","lineHeight","paddingTop","paddingLeft","paddingRight","paddingBottom","borderWidth","boxSizing","whiteSpace","wordWrap","overflowWrap","tabSize"].forEach(c=>{n.style[c]=t.getPropertyValue(c.replace(/[A-Z]/g,d=>"-"+d.toLowerCase()))}),n.style.position="absolute",n.style.visibility="hidden",n.style.whiteSpace="pre-wrap",n.style.wordWrap="break-word",n.style.width=e.clientWidth+"px";let r=e.value.substring(0,e.selectionStart??0);n.textContent=r;let s=document.createElement("span");s.textContent="|",n.appendChild(s),document.body.appendChild(n);let a=s.getBoundingClientRect(),l=e.getBoundingClientRect(),i={top:l.top+(a.top-n.getBoundingClientRect().top)-e.scrollTop,left:l.left+(a.left-n.getBoundingClientRect().left)-e.scrollLeft};return document.body.removeChild(n),i}function ze(e){if(g){if(P){let n=window.getSelection();if(n&&n.rangeCount>0){let o=n.getRangeAt(0).getBoundingClientRect();g.style.left=o.left+"px",g.style.top=o.bottom+4+"px"}else{let t=e.getBoundingClientRect();g.style.left=t.left+"px",g.style.top=t.bottom+2+"px"}}else{let n=We(e);g.style.left=n.left+"px",g.style.top=n.top+18+"px"}g.style.minWidth="220px"}}var xe=null,Le=null,ke=null,O=null;function Ce(e,n,t,o){xe=e,Le=n,ke=t,O=o||null}function je(e){return!!(e==="$secret"||e.startsWith("$secret.")&&e.split(".").length===2)}function He(e){if(!I)return;let n=je(e),t=I,o=P,r=Y;if(o){let s=t,a=s,l=a._getRawText?a._getRawText():s.textContent||"",i=window.getSelection(),c=l.length;if(i&&i.rangeCount>0){let p=i.getRangeAt(0),h=document.createRange();h.selectNodeContents(s),h.setEnd(p.startContainer,p.startOffset),c=h.toString().length}let d,u;if(n){d="{{"+e+".";let p=c;l.substring(c).startsWith("}}")&&(p+=2);let v=l.substring(0,w)+d+l.substring(p);u=w+d.length,a._setRawText?a._setRawText(v):O&&O(v)}else{d="{{"+e+"}}";let p=c;l.substring(c).startsWith("}}")&&(p+=2);let v=l.substring(0,w)+d+l.substring(p);u=w+d.length,a._setRawText?a._setRawText(v):O&&O(v)}if(r?r():Le?.(),ke?.(s,u),n){x(),setTimeout(()=>{te(s,r||(()=>{}))},0);return}}else{let s=t,a=s.value,l=s.selectionStart??a.length,i,c;if(n){i="{{"+e+".";let d=l;a.substring(l).startsWith("}}")&&(d+=2),s.value=a.substring(0,w)+i+a.substring(d),c=w+i.length}else{i="{{"+e+"}}";let d=l;a.substring(l).startsWith("}}")&&(d+=2),s.value=a.substring(0,w)+i+a.substring(d),c=w+i.length}if(s.selectionStart=c,s.selectionEnd=c,s.focus(),r?r():xe?.(),n){x(),setTimeout(()=>{ee(s,r||(()=>{}))},0);return}}x()}function x(){g&&(g.remove(),g=null),I=null,A=[],L=0,Y=null}function ne(e){return!g||A.length===0?!1:e.key==="ArrowDown"?(e.preventDefault(),L=(L+1)%A.length,Z(),!0):e.key==="ArrowUp"?(e.preventDefault(),L=(L-1+A.length)%A.length,Z(),!0):e.key==="Enter"||e.key==="Tab"?(e.preventDefault(),He(A[L].name),!0):e.key==="Escape"?(e.preventDefault(),x(),!0):!1}function se(){return g!==null}var q={},B={},$=!1,N=new Set,Ge=null,re=null;function Re(e){re=e}function ae(){return $}function Me(e){$=e}function F(e){return ge(e,{resolved:q,sources:B,showResolved:$,secretKeys:N})}function oe(e,n){let t=window.getSelection();if(!t)return;let o=document.createRange(),r=0,s=!1;function a(l){if(l.nodeType===Node.TEXT_NODE){let i=(l.textContent||"").length;if(r+i>=n)return o.setStart(l,n-r),o.collapse(!0),!0;r+=i}else for(let i=0;i<l.childNodes.length;i++)if(a(l.childNodes[i]))return!0;return!1}s=a(e),s||(o.selectNodeContents(e),o.collapse(!1)),t.removeAllRanges(),t.addRange(o)}function C(){document.querySelectorAll(".var-cell").forEach(e=>{let n=e.querySelector('input[type="text"]'),t=e.querySelector(".var-overlay");n&&t&&e.classList.contains("var-overlay-active")&&(t.innerHTML=F(b(n.value)))}),document.querySelectorAll(".val-ce").forEach(e=>{let n=e._getRawText;if(n&&document.activeElement!==e){let t=n();t&&(e.innerHTML=F(b(t)))}})}function Ve(e){let n=e.parentElement;n.classList.add("var-cell");let t=document.createElement("div");t.className="var-overlay",n.appendChild(t);function o(){t.innerHTML=F(b(e.value))}function r(){n.classList.add("var-overlay-active"),o()}function s(){n.classList.remove("var-overlay-active")}e.addEventListener("input",()=>{o(),ee(e,o)}),e.addEventListener("focus",s),e.addEventListener("blur",()=>{r(),x()}),e.addEventListener("keydown",a=>{se()&&ne(a)}),t.addEventListener("click",a=>{let l=a.target.closest(".tk-var, .tk-var-resolved");l&&l.dataset.var?X(l,l.dataset.var,{getResolvedVariables:()=>q,getVariableSources:()=>B,getSecretKeys:()=>N,postMessage:re??void 0}):(s(),e.focus())}),document.activeElement!==e&&r()}function le(e,n,t){let o=n||"";e._getRawText=()=>o,e._setRawText=s=>{o=s};function r(){if(!o){e.innerHTML="";return}let s=window.getSelection(),a=0;if(s&&s.rangeCount>0&&e.contains(s.anchorNode)){let l=s.getRangeAt(0),i=document.createRange();i.selectNodeContents(e),i.setEnd(l.startContainer,l.startOffset),a=i.toString().length}e.innerHTML=F(b(o)),s&&document.activeElement===e&&oe(e,a)}r(),e.addEventListener("input",()=>{if($){$=!1,C(),Ge?.();return}let s=window.getSelection(),a=0;if(s&&s.rangeCount>0&&e.contains(s.anchorNode)){let l=s.getRangeAt(0),i=document.createRange();i.selectNodeContents(e),i.setEnd(l.startContainer,l.startOffset),a=i.toString().length}o=e.textContent||"",r(),oe(e,a),t(),te(e,r)}),e.addEventListener("keydown",s=>{se()&&ne(s)}),e.addEventListener("blur",()=>{x()}),e.addEventListener("click",s=>{let a=s.target.closest(".tk-var, .tk-var-resolved");a&&a.dataset.var&&X(a,a.dataset.var,{getResolvedVariables:()=>q,getVariableSources:()=>B,getSecretKeys:()=>N,postMessage:re??void 0})})}function Oe(e){if(e.type!=="variablesResolved")return!1;q=e.variables||{},B=e.sources||{},Ee(e.secretProviderNames||[]);let n=e.secretNames||{},t=new Set;for(let[o,r]of Object.entries(n)){Ae(o,r);for(let s of r)t.add(`$secret.${o}.${s}`)}return N=t,C(),!0}var Ie=null;function $e(e){Ie=e}document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="s"&&Ie?.()});function qe(e){be(()=>q),Ce(()=>{C(),e?.extraSyncHighlight?.()},()=>{C(),e?.extraSyncUrlHighlight?.()},oe,e?.setRawUrl)}var W=acquireVsCodeApi(),z=null,ie=!1,K=!1,H=null;function f(e){return document.getElementById(e)}function ce(e){if(!e)return"";let n=document.createElement("div");return n.textContent=e,n.innerHTML}function T(){K||(H&&clearTimeout(H),H=setTimeout(()=>{z&&Ue()},400))}function Ue(){let e=JSON.parse(JSON.stringify(z));e.info=e.info||{},e.info.type="folder",e.info.name=f("infoName").value||void 0;let n=f("infoDescription").value;n?e.info.description=n:delete e.info.description;let t=[];document.querySelectorAll("#defaultHeadersBody tr").forEach(a=>{let l=a.querySelector('input[type="text"]'),i=a.querySelector(".val-ce"),c=a.querySelector('input[type="checkbox"]');if(l?.value){let d={name:l.value,value:i?._getRawText?i._getRawText():i?.textContent||""};c&&!c.checked&&(d.disabled=!0),t.push(d)}}),e.request||(e.request={}),e.request.headers=t.length>0?t:void 0;let o=f("defaultAuthType").value,r=G(o,"dAuth");r!==void 0?e.request.auth=r:delete e.request.auth;let s=[];document.querySelectorAll("#defaultVarsBody tr").forEach(a=>{let l=a.querySelector('input[type="text"]'),i=a.querySelector(".val-ce"),c=a.querySelector('input[type="checkbox"]');if(l?.value){let d={name:l.value,value:i?._getRawText?i._getRawText():i?.textContent||""};c&&!c.checked&&(d.disabled=!0),s.push(d)}}),e.request=e.request||{},e.request.variables=s.length>0?s:void 0,e.request&&Object.keys(e.request).every(a=>e.request[a]===void 0)&&delete e.request,ie=!0,W.postMessage({type:"updateDocument",folder:e})}function Je(e){let n=f(e);n&&n.querySelectorAll(".tab").forEach(t=>{t.addEventListener("click",()=>{let o=t.dataset.tab;n.querySelectorAll(".tab").forEach(a=>a.classList.remove("active")),t.classList.add("active");let r=n.parentElement;r.querySelectorAll(":scope > .tab-content > .tab-panel").forEach(a=>a.classList.remove("active"));let s=r.querySelector(`#panel-${o}`);s&&s.classList.add("active")})})}function Xe(e){let n=f("defaultHeadersBody");n.innerHTML="",(e||[]).forEach(t=>_e(t.name,t.value,t.disabled))}function _e(e,n,t){let o=f("defaultHeadersBody"),r=document.createElement("tr");r.innerHTML=`<td><input type="checkbox" ${t?"":"checked"} /></td><td><input type="text" value="${ce(e||"")}" placeholder="Header name" /></td><td class="val-cell"><div class="val-ce" contenteditable="true" data-placeholder="Header value"></div></td><td><button class="row-delete">\xD7</button></td>`,r.querySelector(".row-delete").addEventListener("click",()=>{r.remove(),T()}),r.querySelector('input[type="text"]').addEventListener("input",T),r.querySelector('input[type="checkbox"]').addEventListener("change",T),le(r.querySelector(".val-ce"),n||"",T),o.appendChild(r)}function Qe(e){let n=f("defaultVarsBody");n.innerHTML="",(e||[]).forEach(t=>Pe(t.name,t.value,t.disabled))}function Pe(e,n,t){let o=f("defaultVarsBody"),r=document.createElement("tr"),s=typeof n=="string"?n:n&&n.data?n.data:"";r.innerHTML=`<td><input type="checkbox" ${t?"":"checked"} /></td><td><input type="text" value="${ce(e||"")}" placeholder="Variable name" /></td><td class="val-cell"><div class="val-ce" contenteditable="true" data-placeholder="Variable value"></div></td><td><button class="row-delete">\xD7</button></td>`,r.querySelector(".row-delete").addEventListener("click",()=>{r.remove(),T()}),r.querySelector('input[type="text"]').addEventListener("input",T),r.querySelector('input[type="checkbox"]').addEventListener("change",T),le(r.querySelector(".val-ce"),s,T),o.appendChild(r)}var Ze={prefix:"dAuth",get fieldsContainer(){return f("defaultAuthFields")},onChange:()=>T(),showInherit:!0,wrapInputs:!0,showTokenStatus:!0,onFieldsRendered:e=>e.forEach(n=>Ve(n))},D=fe({prefix:"dAuth",buildAuth:()=>G(f("defaultAuthType").value,"dAuth"),postMessage:e=>W.postMessage(e),esc:ce});function Fe(){let e=f("defaultAuthType").value;de(e,Ze),e==="oauth2"&&D.requestStatus()}function ue(){f("headersBadge").textContent=String(document.querySelectorAll("#defaultHeadersBody tr").length),f("variablesBadge").textContent=String(document.querySelectorAll("#defaultVarsBody tr").length)}function Ye(e){K=!0,z=JSON.parse(JSON.stringify(e)),f("infoName").value=e.info?.name||"";let n=e.info?.description;f("infoDescription").value=typeof n=="string"?n:n?.content||"",f("folderName").textContent=e.info?.name||"Folder";let t=e.request?.auth;t==="inherit"?f("defaultAuthType").value="inherit":t?.type?f("defaultAuthType").value=t.type:f("defaultAuthType").value="none",Fe(),t&&t!=="inherit"&&t.type&&pe(t,"dAuth"),Xe(e.request?.headers||[]),Qe(e.request?.variables||[]),ue(),K=!1}qe();Re(e=>W.postMessage(e));$e(()=>{H&&(clearTimeout(H),H=null),!K&&z&&Ue()});Je("mainTabs");f("defaultAuthType").addEventListener("change",Fe);f("addDefaultHeaderBtn").addEventListener("click",()=>{_e(),ue(),T()});f("addDefaultVarBtn").addEventListener("click",()=>{Pe(),ue(),T()});f("varToggleBtn").addEventListener("click",()=>{Me(!ae()),f("varToggleBtn").classList.toggle("active",ae()),C()});f("infoName").addEventListener("input",()=>{f("folderName").textContent=f("infoName").value||"Folder",T()});f("infoDescription").addEventListener("input",T);window.addEventListener("message",e=>{let n=e.data;if(n.type==="folderLoaded"){if(ie){ie=!1;return}Ye(n.folder)}Oe(n)&&D.requestStatus(),n.type==="secretValueResolved"&&me(n),n.type==="oauth2TokenStatus"&&D.handleStatus(n.status),n.type==="oauth2Progress"&&D.handleProgress(n.message)});W.postMessage({type:"ready"});})();

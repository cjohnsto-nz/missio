"use strict";(()=>{var T=acquireVsCodeApi(),C=null,b={},M=null,A=!1;function c(){M&&clearTimeout(M),M=setTimeout(()=>{A=!0;let e=U();T.postMessage({type:"updateDocument",request:e})},300)}function a(e){return document.getElementById(e)}function d(e){return document.getElementById(e)}function f(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}var ce=["body","auth","headers","params","settings"],ue=["resp-body","resp-headers"];function Y(e,t,s){e.querySelectorAll(".tab").forEach(n=>n.classList.remove("active"));let o=e.querySelector(`[data-tab="${t}"]`);o&&o.classList.add("active"),s.forEach(n=>{let l=document.getElementById("panel-"+n);l&&l.classList.toggle("active",n===t)})}a("reqTabs").querySelectorAll(".tab").forEach(e=>{e.addEventListener("click",()=>{Y(a("reqTabs"),e.dataset.tab,ce)})});a("respTabs").querySelectorAll(".tab").forEach(e=>{e.addEventListener("click",()=>{Y(a("respTabs"),e.dataset.tab,ue)})});var O=a("divider"),z=a("requestSection"),J=a("responseSection"),$=!1;O.addEventListener("mousedown",()=>{$=!0,O.classList.add("dragging"),document.body.style.cursor="ns-resize",document.body.style.userSelect="none"});document.addEventListener("mousemove",e=>{if(!$)return;let s=document.querySelector(".main-content").getBoundingClientRect(),o=e.clientY-s.top,n=s.height,l=Math.max(15,Math.min(85,o/n*100));z.style.flex="none",z.style.height=l+"%",J.style.flex="none",J.style.height=100-l+"%"});document.addEventListener("mouseup",()=>{$=!1,O.classList.remove("dragging"),document.body.style.cursor="",document.body.style.userSelect=""});var w=a("method");function _(){w.className="method-select "+w.value.toLowerCase()}w.addEventListener("change",()=>{_(),c(),T.postMessage({type:"methodChanged",method:w.value})});function G(e="",t="",s="query",o=!1){let n=a("paramsBody"),l=document.createElement("tr");l.innerHTML='<td><input type="checkbox" class="p-enabled" '+(o?"":"checked")+' /></td><td><input type="text" class="p-name" value="'+f(e)+'" placeholder="name" /></td><td><input type="text" class="p-value" value="'+f(t)+'" placeholder="value" /></td><td><select class="p-type auth-select" style="margin:0;"><option value="query"'+(s==="query"?" selected":"")+'>query</option><option value="path"'+(s==="path"?" selected":"")+'>path</option></select></td><td><button class="row-delete">\xD7</button></td>',l.querySelector(".row-delete").addEventListener("click",()=>{l.remove(),B(),c()}),l.addEventListener("input",c),l.addEventListener("change",c),n.appendChild(l),B()}function Q(e="",t="",s=!1){let o=a("headersBody"),n=document.createElement("tr");n.innerHTML='<td><input type="checkbox" class="h-enabled" '+(s?"":"checked")+' /></td><td><input type="text" class="h-name" value="'+f(e)+'" placeholder="name" /></td><td><input type="text" class="h-value" value="'+f(t)+'" placeholder="value" /></td><td><button class="row-delete">\xD7</button></td>',n.querySelector(".row-delete").addEventListener("click",()=>{n.remove(),B(),c()}),n.addEventListener("input",c),n.addEventListener("change",c),o.appendChild(n),B()}function Z(e="",t="",s=!1){let o=a("bodyFormBody"),n=document.createElement("tr");n.innerHTML='<td><input type="checkbox" class="f-enabled" '+(s?"":"checked")+' /></td><td><input type="text" class="f-name" value="'+f(e)+'" placeholder="name" /></td><td><input type="text" class="f-value" value="'+f(t)+'" placeholder="value" /></td><td><button class="row-delete">\xD7</button></td>',n.querySelector(".row-delete").addEventListener("click",()=>{n.remove(),c()}),n.addEventListener("input",c),n.addEventListener("change",c),o.appendChild(n)}function B(){let e=document.querySelectorAll("#paramsBody tr"),t=document.querySelectorAll("#headersBody tr");a("paramsBadge").textContent=String(e.length),a("headersBadge").textContent=String(t.length)}var S="none",L="json";function R(e){S=e,document.querySelectorAll("#bodyTypePills .pill").forEach(n=>{n.classList.toggle("active",n.dataset.bodyType===e)});let t=a("bodyRawEditor"),s=a("bodyFormEditor"),o=a("bodyLangMode");e==="none"?(t.style.display="none",s.style.display="none",o.style.display="none"):e==="form-urlencoded"||e==="multipart-form"?(t.style.display="none",s.style.display="block",o.style.display="none"):(t.style.display="flex",t.style.flexDirection="column",t.style.flex="1",s.style.display="none",o.style.display="block")}document.querySelectorAll("#bodyTypePills .pill").forEach(e=>{e.addEventListener("click",()=>{R(e.dataset.bodyType)})});function m(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function pe(e){let t=m(e);return t=t.replace(/(")((?:[^"\\]|\\.)*)(")\s*:/g,"<span class='tk-key'>&quot;$2&quot;</span>:"),t=t.replace(/(")((?:[^"\\]|\\.)*)(")/g,"<span class='tk-str'>&quot;$2&quot;</span>"),t=t.replace(/\b(-?\d+\.?\d*(?:e[+-]?\d+)?)\b/gi,"<span class='tk-num'>$1</span>"),t=t.replace(/\b(true|false|null)\b/g,"<span class='tk-kw'>$1</span>"),t}function ye(e){let t=m(e);return t=t.replace(/(&lt;\/?)([\w:-]+)/g,"$1<span class='tk-tag'>$2</span>"),t=t.replace(/([\w:-]+)(=)(")((?:[^"]*))(")/g,"<span class='tk-attr'>$1</span>$2<span class='tk-str'>&quot;$4&quot;</span>"),t}function ee(e){return e.replace(/\{\{(\s*[\w.]+\s*)\}\}/g,(t,s)=>{let o=s.trim();return"<span class='"+(o in b?"tk-var":"tk-var tk-var-unresolved")+"' data-var='"+m(o)+"'>{{"+m(s)+"}}</span>"})}function te(e,t){let s;return t==="json"?s=pe(e):t==="xml"||t==="html"?s=ye(e):s=m(e),ee(s)}function ne(){let e=a("bodyData"),t=a("lineNumbers"),s=(e.value.match(/\n/g)||[]).length+1;if(t.children.length!==s){let n="";for(let l=1;l<=s;l++)n+="<span>"+l+"</span>";t.innerHTML=n}t.style.top=-e.scrollTop+"px"}function E(){try{let e=a("bodyData"),t=a("bodyHighlight");t.innerHTML=te(e.value,L)+`
`,ne()}catch{}}var k=null;function j(e,t){F();let s=e.getBoundingClientRect(),o=t in b,n=document.createElement("div");n.className="var-tooltip",n.innerHTML="<div class='var-name'>{{"+m(t)+"}}</div>"+(o?"<div class='var-value'>"+m(b[t])+"</div>":"<div class='var-unresolved'>Unresolved variable</div>")+"<div class='var-actions'><button class='var-action-btn' data-action='edit'>Edit Variable</button><button class='var-action-btn' data-action='copy'>"+(o?"Copy Value":"Copy Name")+"</button></div>",n.style.left=s.left+"px",n.style.top=s.bottom+4+"px",document.body.appendChild(n),k=n,n.querySelectorAll(".var-action-btn").forEach(l=>{l.addEventListener("click",()=>{let r=l.dataset.action;if(r==="edit")T.postMessage({type:"editVariable",variableName:t});else if(r==="copy"){let u=o?b[t]:"{{"+t+"}}";navigator.clipboard.writeText(u).catch(()=>{})}F()})}),setTimeout(()=>{document.addEventListener("click",se)},0)}function F(){k&&(k.remove(),k=null),document.removeEventListener("click",se)}function se(e){k&&!k.contains(e.target)&&F()}a("bodyHighlight").addEventListener("click",e=>{let t=e.target.closest(".tk-var");t&&t.dataset.var&&j(t,t.dataset.var)});function me(){return a("url").textContent||""}function ge(e){a("url").textContent=e,P()}function P(){let e=a("url"),t=e.textContent||"";if(!t){e.innerHTML="";return}let s=window.getSelection(),o=0;if(s&&s.rangeCount>0){let n=s.getRangeAt(0),l=document.createRange();l.selectNodeContents(e),l.setEnd(n.startContainer,n.startOffset),o=l.toString().length}e.innerHTML=ee(m(t)),s&&document.activeElement===e&&ae(e,o)}function ae(e,t){let s=window.getSelection();if(!s)return;let o=document.createRange(),n=0,l=!1;function r(u){if(u.nodeType===Node.TEXT_NODE){let p=(u.textContent||"").length;if(n+p>=t)return o.setStart(u,t-n),o.collapse(!0),!0;n+=p}else for(let p=0;p<u.childNodes.length;p++)if(r(u.childNodes[p]))return!0;return!1}l=r(e),l||(o.selectNodeContents(e),o.collapse(!1)),s.removeAllRanges(),s.addRange(o)}a("url").addEventListener("click",e=>{let t=e.target.closest(".tk-var");t&&t.dataset.var&&j(t,t.dataset.var)});a("url").addEventListener("input",()=>{P(),he(a("url")),c()});function fe(){let e=a("bodyData"),t=a("bodyHighlight");t.scrollTop=e.scrollTop,t.scrollLeft=e.scrollLeft,ne()}a("bodyData").addEventListener("input",()=>{E(),ve(a("bodyData")),c()});a("bodyData").addEventListener("scroll",fe);a("bodyData").addEventListener("click",e=>{let t=e,s=a("bodyData");s.style.pointerEvents="none";let o=document.elementFromPoint(t.clientX,t.clientY);if(s.style.pointerEvents="",o){let n=o.closest(".tk-var");n&&n.dataset.var&&j(n,n.dataset.var)}});var i=null,y=[],g=0,H=null,x=0,N=!1;function oe(e,t){let s=e.substring(0,t),o=s.lastIndexOf("{{");if(o===-1)return null;let n=s.substring(o+2);if(n.includes("}}"))return null;let l=n.trim();return/^[\w.]*$/.test(l)?l:null}function ve(e){let t=e.selectionStart??0,s=oe(e.value,t);if(s===null){v();return}H=e,N=!1,x=e.value.lastIndexOf("{{",t-1),le(s,e)}function he(e){let t=window.getSelection();if(!t||t.rangeCount===0)return;let s=e.textContent||"",o=t.getRangeAt(0),n=document.createRange();n.selectNodeContents(e),n.setEnd(o.startContainer,o.startOffset);let l=n.toString().length,r=oe(s,l);if(r===null){v();return}H=e,N=!0,x=s.lastIndexOf("{{",l-1),le(r,e)}function le(e,t){let s=Object.keys(b);if(s.length===0){v();return}let o=e.toLowerCase();if(y=s.filter(n=>n.toLowerCase().startsWith(o)),y.length===0){v();return}g=0,i||(i=document.createElement("div"),i.className="var-autocomplete",document.body.appendChild(i)),K(),Ee(t)}function K(){i&&(i.innerHTML=y.map((e,t)=>{let s=b[e]||"";return"<div class='"+(t===g?"var-autocomplete-item selected":"var-autocomplete-item")+"' data-index='"+t+"'><span class='var-ac-name'>"+m(e)+"</span><span class='var-ac-value'>"+m(s)+"</span></div>"}).join(""),i.querySelectorAll(".var-autocomplete-item").forEach(e=>{e.addEventListener("mousedown",t=>{t.preventDefault();let s=parseInt(e.dataset.index||"0");re(y[s])})}))}function be(e){let t=document.createElement("div"),s=window.getComputedStyle(e);["fontFamily","fontSize","fontWeight","letterSpacing","lineHeight","paddingTop","paddingLeft","paddingRight","paddingBottom","borderWidth","boxSizing","whiteSpace","wordWrap","overflowWrap","tabSize"].forEach(h=>{t.style[h]=s.getPropertyValue(h.replace(/[A-Z]/g,q=>"-"+q.toLowerCase()))}),t.style.position="absolute",t.style.visibility="hidden",t.style.whiteSpace="pre-wrap",t.style.wordWrap="break-word",t.style.width=e.clientWidth+"px";let n=e.value.substring(0,e.selectionStart??0);t.textContent=n;let l=document.createElement("span");l.textContent="|",t.appendChild(l),document.body.appendChild(t);let r=l.getBoundingClientRect(),u=e.getBoundingClientRect(),p={top:u.top+(r.top-t.getBoundingClientRect().top)-e.scrollTop,left:u.left+(r.left-t.getBoundingClientRect().left)-e.scrollLeft};return document.body.removeChild(t),p}function Ee(e){if(i){if(N){let t=window.getSelection();if(t&&t.rangeCount>0){let o=t.getRangeAt(0).getBoundingClientRect();i.style.left=o.left+"px",i.style.top=o.bottom+4+"px"}else{let s=e.getBoundingClientRect();i.style.left=s.left+"px",i.style.top=s.bottom+2+"px"}}else{let t=be(e);i.style.left=t.left+"px",i.style.top=t.top+18+"px"}i.style.minWidth="220px"}}function re(e){if(H){if(N){let t=H,s=t.textContent||"",o=window.getSelection(),n=s.length;if(o&&o.rangeCount>0){let q=o.getRangeAt(0),V=document.createRange();V.selectNodeContents(t),V.setEnd(q.startContainer,q.startOffset),n=V.toString().length}let l="{{"+e+"}}",r=n;s.substring(n).startsWith("}}")&&(r+=2);let p=s.substring(0,x)+l+s.substring(r);t.textContent=p,P();let h=x+l.length;ae(t,h)}else{let t=H,s=t.value,o=t.selectionStart??s.length,n="{{"+e+"}}",l=o;s.substring(o).startsWith("}}")&&(l+=2),t.value=s.substring(0,x)+n+s.substring(l);let u=x+n.length;t.selectionStart=u,t.selectionEnd=u,t.focus(),E()}v()}}function v(){i&&(i.remove(),i=null),H=null,y=[],g=0}function ie(e){!i||y.length===0||(e.key==="ArrowDown"?(e.preventDefault(),g=(g+1)%y.length,K()):e.key==="ArrowUp"?(e.preventDefault(),g=(g-1+y.length)%y.length,K()):e.key==="Enter"||e.key==="Tab"?(e.preventDefault(),re(y[g])):e.key==="Escape"&&(e.preventDefault(),v()))}a("bodyData").addEventListener("keydown",e=>{i&&ie(e)});a("url").addEventListener("keydown",e=>{if(i){ie(e);return}e.key==="Enter"&&e.preventDefault()});a("bodyData").addEventListener("blur",()=>{setTimeout(v,150)});a("url").addEventListener("blur",()=>{setTimeout(v,150)});function W(){let e=a("authType").value,t=a("authFields");t.innerHTML="",e==="bearer"?t.innerHTML='<div class="auth-row"><label>Token</label><input type="text" id="authToken" placeholder="{{token}}" /></div>':e==="basic"?t.innerHTML='<div class="auth-row"><label>Username</label><input type="text" id="authUsername" placeholder="username" /></div><div class="auth-row"><label>Password</label><input type="password" id="authPassword" placeholder="password" /></div>':e==="apikey"&&(t.innerHTML='<div class="auth-row"><label>Key</label><input type="text" id="authKey" placeholder="X-Api-Key" /></div><div class="auth-row"><label>Value</label><input type="text" id="authValue" placeholder="{{apiKey}}" /></div><div class="auth-row"><label>In</label><select id="authPlacement" class="auth-select" style="margin:0;"><option value="header">Header</option><option value="query">Query</option></select></div>')}function U(){let e=C?JSON.parse(JSON.stringify(C)):{};e.info||(e.info={type:"http"}),e.http||(e.http={}),e.settings||(e.settings={}),e.http.method=w.value,e.http.url=me();let t=[];document.querySelectorAll("#paramsBody tr").forEach(n=>{t.push({name:n.querySelector(".p-name").value,value:n.querySelector(".p-value").value,type:n.querySelector(".p-type").value,disabled:!n.querySelector(".p-enabled").checked})}),e.http.params=t;let s=[];if(document.querySelectorAll("#headersBody tr").forEach(n=>{s.push({name:n.querySelector(".h-name").value,value:n.querySelector(".h-value").value,disabled:!n.querySelector(".h-enabled").checked})}),e.http.headers=s,S!=="none")if(S==="form-urlencoded"||S==="multipart-form"){let n=[];document.querySelectorAll("#bodyFormBody tr").forEach(l=>{n.push({name:l.querySelector(".f-name").value,value:l.querySelector(".f-value").value,disabled:!l.querySelector(".f-enabled").checked})}),e.http.body={type:S,data:n}}else e.http.body={type:L,data:a("bodyData").value};else delete e.http.body;let o=a("authType").value;return o==="bearer"?e.http.auth={type:"bearer",token:d("authToken")?.value||""}:o==="basic"?e.http.auth={type:"basic",username:d("authUsername")?.value||"",password:d("authPassword")?.value||""}:o==="apikey"?e.http.auth={type:"apikey",key:d("authKey")?.value||"",value:d("authValue")?.value||"",placement:a("authPlacement")?.value||"header"}:o==="inherit"?e.http.auth="inherit":delete e.http.auth,e.settings.timeout=parseInt(d("settingTimeout").value)||3e4,e.settings.encodeUrl=d("settingEncodeUrl").checked,e.settings.followRedirects=d("settingFollowRedirects").checked,e.settings.maxRedirects=parseInt(d("settingMaxRedirects").value)||5,e}var D=null;function Le(){a("respLoading").style.display="flex",a("respEmpty").style.display="none",a("respBodyWrap").style.display="none",a("responseBar").style.display="none",a("respTabs").style.display="none"}function de(){a("respLoading").style.display="none"}function Te(){let e=U();a("sendBtn").classList.add("sending"),a("sendBtn").disabled=!0,a("sendBtn").textContent="Sending...",Le(),T.postMessage({type:"sendRequest",request:e})}function xe(){M&&(clearTimeout(M),M=null),A=!0;let e=U();T.postMessage({type:"saveDocument",request:e})}function Me(){a("responseBar").style.display="none",a("respTabs").style.display="none",a("respBodyWrap").style.display="none",a("respEmpty").style.display="block",D=null,I=""}function ke(e){C=e,Me();let t=e.http||{};if(w.value=(t.method||"GET").toUpperCase(),_(),ge(t.url||""),a("paramsBody").innerHTML="",(t.params||[]).forEach(n=>G(n.name,n.value,n.type||"query",n.disabled)),a("headersBody").innerHTML="",(t.headers||[]).forEach(n=>Q(n.name,n.value,n.disabled)),t.body){let n=Array.isArray(t.body)?(t.body.find(l=>l.selected)||t.body[0])?.body:t.body;n&&(n.type==="form-urlencoded"||n.type==="multipart-form"?(R(n.type),a("bodyFormBody").innerHTML="",(n.data||[]).forEach(l=>Z(l.name,l.value,l.disabled))):(R("raw"),L=n.type||"json",a("bodyLangMode").value=L,n.data&&(a("bodyData").value=n.data),E()))}else R("none");let s=t.auth;s==="inherit"?a("authType").value="inherit":s&&s.type?(a("authType").value=s.type,W(),s.type==="bearer"?setTimeout(()=>{let n=d("authToken");n&&(n.value=s.token||"")},0):s.type==="basic"?setTimeout(()=>{let n=d("authUsername");n&&(n.value=s.username||"");let l=d("authPassword");l&&(l.value=s.password||"")},0):s.type==="apikey"&&setTimeout(()=>{let n=d("authKey");n&&(n.value=s.key||"");let l=d("authValue");l&&(l.value=s.value||"");let r=a("authPlacement");r&&(r.value=s.placement||"header")},0)):a("authType").value="none",W();let o=e.settings||{};d("settingTimeout").value=o.timeout!==void 0&&o.timeout!=="inherit"?o.timeout:"30000",d("settingEncodeUrl").checked=o.encodeUrl!==void 0&&o.encodeUrl!=="inherit"?o.encodeUrl:!0,d("settingFollowRedirects").checked=o.followRedirects!==void 0&&o.followRedirects!=="inherit"?o.followRedirects:!0,d("settingMaxRedirects").value=o.maxRedirects!==void 0&&o.maxRedirects!=="inherit"?o.maxRedirects:"5",B()}var I="";function He(e){let t=a("respLineNumbers"),s=(e.match(/\n/g)||[]).length+1,o="";for(let n=1;n<=s;n++)o+="<span>"+n+"</span>";t.innerHTML=o}function X(e){de(),D=e,a("sendBtn").classList.remove("sending"),a("sendBtn").disabled=!1,a("sendBtn").textContent="Send",a("responseBar").style.display="flex",a("respTabs").style.display="flex",a("respEmpty").style.display="none",a("respBodyWrap").style.display="block";let t=a("statusBadge");t.textContent=e.status+" "+e.statusText;let s=Math.floor(e.status/100);t.className="status-badge s"+s+"xx",a("responseMeta").textContent=e.duration+"ms \u2022 "+we(e.size);let o=e.body||"",n=e.headers&&e.headers["content-type"]||"",l="text";if(n.includes("json")){l="json";try{o=JSON.stringify(JSON.parse(o),null,2)}catch{}}else n.includes("xml")?l="xml":n.includes("html")&&(l="html");I=o,a("respBodyPre").innerHTML=te(o,l)+`
`,He(o);let r=a("respHeadersBody");r.innerHTML="",e.headers&&Object.entries(e.headers).forEach(([u,p])=>{let h=document.createElement("tr");h.innerHTML="<td>"+f(u)+"</td><td>"+f(String(p))+"</td>",r.appendChild(h)})}function we(e){return e<1024?e+" B":e<1024*1024?(e/1024).toFixed(1)+" KB":(e/(1024*1024)).toFixed(1)+" MB"}window.addEventListener("message",e=>{let t=e.data;switch(t.type){case"requestLoaded":if(A){A=!1;break}ke(t.request);break;case"response":X(t.response);break;case"sending":a("sendBtn").classList.add("sending"),a("sendBtn").disabled=!0,a("sendBtn").textContent="Sending...";break;case"saved":break;case"error":de(),a("sendBtn").classList.remove("sending"),a("sendBtn").disabled=!1,a("sendBtn").textContent="Send";break;case"languageChanged":L=t.language,a("bodyLangMode").value=L,E();break;case"bodyUpdated":a("bodyData").value=t.content,E();break;case"examplesUpdated":C&&(C.examples=t.examples||[]);break;case"loadExample":{let s=t.example;if(s.response){let o={};if(s.response.headers)for(let n of s.response.headers)o[n.name]=n.value;X({status:s.response.status,statusText:s.response.statusText,headers:o,body:s.response.body?.data??"",duration:0,size:(s.response.body?.data??"").length})}break}case"variablesResolved":b=t.variables||{},E(),P();break}});a("sendBtn").addEventListener("click",Te);a("copyRespBtn").addEventListener("click",()=>{I&&navigator.clipboard.writeText(I).then(()=>{let e=a("copyRespBtn");e.textContent="Copied!",setTimeout(()=>{e.textContent="Copy"},1500)})});a("saveExampleBtn").addEventListener("click",()=>{if(!D)return;let e=U();T.postMessage({type:"saveExample",request:e,response:D})});a("addParamBtn").addEventListener("click",()=>G());a("addHeaderBtn").addEventListener("click",()=>Q());a("addFormFieldBtn").addEventListener("click",()=>Z());a("authType").addEventListener("change",()=>{W(),c()});a("panel-auth").addEventListener("input",c);a("panel-auth").addEventListener("change",c);a("panel-settings").addEventListener("input",c);a("panel-settings").addEventListener("change",c);a("bodyLangMode").addEventListener("change",()=>{L=a("bodyLangMode").value,E(),c()});document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="s"&&(e.preventDefault(),xe())});T.postMessage({type:"ready"});})();

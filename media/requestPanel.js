"use strict";(()=>{var S=acquireVsCodeApi(),K=null,z=null,Ie=!1,G="none",X="json";function et(e){K=e}function qe(e){z=e}function be(e){Ie=e}function tt(e){G=e}function Ee(e){X=e}function l(e){return document.getElementById(e)}function L(e){return document.getElementById(e)}function J(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}var on=/\{\{(\s*[\w.$-]+\s*)\}\}/g,nt=/^[\w.$-]*$/;function f(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var an=new Set(["$guid","$timestamp","$randomInt"]);function st(e,t){return e.replace(on,(n,o)=>{let a=o.trim(),s=a in t.resolved,r=an.has(a),i=t.secretKeys?.has(a)??!1,c=s||r||i,u=t.sources[a]||(i?"secret":r?"dynamic":"unknown");return t.showResolved&&s?"<span class='"+("tk-var-resolved tk-src-"+u)+"' data-var='"+f(a)+"' title='{{"+f(a)+"}} ("+u+")'>"+f(t.resolved[a])+"</span>":"<span class='"+(c?"tk-var tk-src-"+u:"tk-var tk-var-unresolved")+"' data-var='"+f(a)+"'>{{"+f(o)+"}}</span>"})}var O=[{key:"environment",label:"Environment",badge:"E",badgeClass:"var-scope-badge-E"},{key:"collection",label:"Collection",badge:"C",badgeClass:"var-scope-badge-C"},{key:"global",label:"Globals",badge:"G",badgeClass:"var-scope-badge-G"}];function ot(e){return e==="environment"||e==="dotenv"?O[0]:e==="collection"||e==="folder"?O[1]:e==="global"?O[2]:O[0]}var R=null,Be=null,de=null,Q=!1;function at(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}function rt(e){R&&!R.contains(e.target)&&ue()}function ue(){R&&(R.remove(),R=null),Be=null,document.removeEventListener("click",rt)}function lt(e){if(!R||e.secretRef!==Be)return;let t=R.querySelector(".var-secret-value"),n=R.querySelector('.var-action-btn[data-action="reveal"]');if(e.error){t&&(t.textContent=e.error,t.style.color="#f48771",t.style.fontStyle="normal"),n&&(n.textContent="Reveal Value");return}let o=e.value??"";de=o,t&&(t.textContent=o,t.style.cssText=""),n&&(n.textContent="Hide Value"),Q=!0;let a=R.querySelector('.var-action-btn[data-action="copy"]');a&&(a.textContent="Copy Value",a.dataset.secretValue=o)}function W(e,t,n){ue(),de=null,Q=!1;let o=e.getBoundingClientRect(),a=n.getResolvedVariables(),s=n.getVariableSources(),r=n.getSecretKeys?.()??new Set,i=t in a,c=r.has(t),u=s[t]||(c?"secret":""),d=c&&!i,p=document.createElement("div");p.className="var-tooltip";let v="";if(d)v+="<div class='var-name'>{{"+at(t)+"}}</div><div class='var-source tk-src-secret'>Secret Provider</div><div class='var-secret-value var-value' style='font-style:italic;opacity:0.7'>Value hidden</div><div class='var-actions'>"+(n.postMessage?"<button class='var-action-btn' data-action='reveal'>Reveal Value</button>":"")+"<button class='var-action-btn' data-action='copy'>Copy Name</button></div>";else{let y=i?a[t]:"",C=i?ot(u):null;v+="<input type='text' class='var-tooltip-value-input' placeholder='Enter value' value='"+at(y).replace(/'/g,"&#39;")+"' />";let g=C||O[0];v+="<div class='var-tooltip-scope-row'><div class='var-scope-dropdown'><button class='var-scope-trigger'><span class='var-scope-badge "+g.badgeClass+"'>"+g.badge+"</span><span>Save to "+g.label+" \u25BE</span></button><div class='var-scope-menu'>"+O.map(m=>"<button class='var-scope-option' data-scope='"+m.key+"'><span class='var-scope-badge "+m.badgeClass+"'>"+m.badge+"</span><span>"+m.label+"</span></button>").join("")+"</div></div></div>"}p.innerHTML=v,p.style.left=o.left+"px",p.style.top=o.bottom+4+"px",document.body.appendChild(p),R=p;let T=(i?ot(u):O[0]).key,b=p.querySelector(".var-scope-trigger"),w=p.querySelector(".var-scope-menu");b&&w&&(b.addEventListener("click",y=>{y.stopPropagation(),w.classList.toggle("open")}),p.querySelectorAll(".var-scope-option").forEach(y=>{y.addEventListener("click",C=>{C.stopPropagation();let g=y.dataset.scope;T=g;let m=O.find(U=>U.key===g)||O[0];b.innerHTML="<span class='var-scope-badge "+m.badgeClass+"'>"+m.badge+"</span><span>Save to "+m.label+" \u25BE</span>",w.classList.remove("open")})}));let N=p.querySelector(".var-tooltip-value-input");N&&(setTimeout(()=>N.focus(),0),N.addEventListener("keydown",y=>{y.key==="Enter"&&(y.preventDefault(),$()),y.key==="Escape"&&ue()}));function $(){let y=N?.value??"";n.postMessage&&(n.postMessage({type:"updateVariable",varName:t,value:y,scope:T}),ue())}p.querySelectorAll(".var-action-btn").forEach(y=>{y.addEventListener("click",C=>{C.stopPropagation();let g=y.dataset.action;if(g==="copy"){let U=y.dataset.secretValue??(i?a[t]:"{{"+t+"}}");navigator.clipboard.writeText(U).catch(()=>{}),ue()}else if(g==="reveal"){let m=p.querySelector(".var-secret-value");de!==null?(Q=!Q,m&&(m.textContent=Q?de:"\u2022".repeat(Math.min(de.length,20))),y.textContent=Q?"Hide Value":"Show Value"):(Be=t,m&&(m.textContent="Resolving\u2026",m.style.cssText="font-style:italic;opacity:0.7"),y.textContent="Resolving\u2026",n.postMessage({type:"resolveSecret",secretRef:t}))}})}),setTimeout(()=>{document.addEventListener("click",rt)},0)}var it=()=>({});function ct(e){it=e}var E=null,A=[],P=0,me=null,I=0,Te=!1,Ve=null,rn=[{name:"$guid",detail:"Generate a random UUID"},{name:"$timestamp",detail:"Current Unix timestamp"},{name:"$randomInt",detail:"Random integer 0\u20131000"}],Oe=[],dt=new Map;function ut(e){Oe=e}function pt(e,t){dt.set(e,t)}function mt(e,t){let n=e.substring(0,t),o=n.lastIndexOf("{{");if(o===-1)return null;let a=n.substring(o+2);if(a.includes("}}"))return null;let s=a.trim();return nt.test(s)?s:null}function fe(e,t){let n=e.selectionStart??0,o=mt(e.value,n);if(o===null){M();return}me=e,Te=!1,I=e.value.lastIndexOf("{{",n-1),ft(o,e,t)}function ve(e,t){let n=window.getSelection();if(!n||n.rangeCount===0)return;let o=e.textContent||"",a=n.getRangeAt(0),s=document.createRange();s.selectNodeContents(e),s.setEnd(a.startContainer,a.startOffset);let r=s.toString().length,i=mt(o,r);if(i===null){M();return}me=e,Te=!0,I=o.lastIndexOf("{{",r-1),ft(i,e,t)}function ft(e,t,n){Ve=n;let o=e.toLowerCase(),a=[],s=it();for(let i of Object.keys(s))a.push({name:i,detail:s[i]});for(let i of rn)a.push(i);if(o===""||"$secret".startsWith(o))Oe.length>0&&a.push({name:"$secret",detail:"Secret provider"});else if(o.startsWith("$secret.")){let i=o.substring(8),c=i.indexOf(".");if(c===-1)for(let u of Oe)u.toLowerCase().startsWith(i)&&a.push({name:"$secret."+u,detail:"Key Vault provider"});else{let u=i.substring(0,c),d=i.substring(c+1),p=dt.get(u)||[];for(let v of p)v.toLowerCase().startsWith(d)&&a.push({name:"$secret."+u+"."+v,displayName:v,detail:"Secret"})}}let r=new Set;A=[];for(let i of a)i.name.toLowerCase().startsWith(o)&&!r.has(i.name)&&(r.add(i.name),A.push(i));if(A.length===0){M();return}P=0,E||(E=document.createElement("div"),E.className="var-autocomplete",document.body.appendChild(E)),De(),cn(t)}function De(){E&&(E.innerHTML=A.map((e,t)=>"<div class='"+(t===P?"var-autocomplete-item selected":"var-autocomplete-item")+"' data-index='"+t+"'><span class='var-ac-name'>"+f(e.displayName||e.name)+"</span><span class='var-ac-value'>"+f(e.detail||"")+"</span></div>").join(""),E.querySelectorAll(".var-autocomplete-item").forEach(e=>{e.addEventListener("mousedown",t=>{t.preventDefault();let n=parseInt(e.dataset.index||"0");bt(A[n].name)})}))}function ln(e){let t=document.createElement("div"),n=window.getComputedStyle(e);["fontFamily","fontSize","fontWeight","letterSpacing","lineHeight","paddingTop","paddingLeft","paddingRight","paddingBottom","borderWidth","boxSizing","whiteSpace","wordWrap","overflowWrap","tabSize"].forEach(u=>{t.style[u]=n.getPropertyValue(u.replace(/[A-Z]/g,d=>"-"+d.toLowerCase()))}),t.style.position="absolute",t.style.visibility="hidden",t.style.whiteSpace="pre-wrap",t.style.wordWrap="break-word",t.style.width=e.clientWidth+"px";let a=e.value.substring(0,e.selectionStart??0);t.textContent=a;let s=document.createElement("span");s.textContent="|",t.appendChild(s),document.body.appendChild(t);let r=s.getBoundingClientRect(),i=e.getBoundingClientRect(),c={top:i.top+(r.top-t.getBoundingClientRect().top)-e.scrollTop,left:i.left+(r.left-t.getBoundingClientRect().left)-e.scrollLeft};return document.body.removeChild(t),c}function cn(e){if(E){if(Te){let t=window.getSelection();if(t&&t.rangeCount>0){let o=t.getRangeAt(0).getBoundingClientRect();E.style.left=o.left+"px",E.style.top=o.bottom+4+"px"}else{let n=e.getBoundingClientRect();E.style.left=n.left+"px",E.style.top=n.bottom+2+"px"}}else{let t=ln(e);E.style.left=t.left+"px",E.style.top=t.top+18+"px"}E.style.minWidth="220px"}}var vt=null,gt=null,ht=null,pe=null;function yt(e,t,n,o){vt=e,gt=t,ht=n,pe=o||null}function dn(e){return!!(e==="$secret"||e.startsWith("$secret.")&&e.split(".").length===2)}function bt(e){if(!me)return;let t=dn(e),n=me,o=Te,a=Ve;if(o){let s=n,r=s,i=r._getRawText?r._getRawText():s.textContent||"",c=window.getSelection(),u=i.length;if(c&&c.rangeCount>0){let v=c.getRangeAt(0),T=document.createRange();T.selectNodeContents(s),T.setEnd(v.startContainer,v.startOffset),u=T.toString().length}let d,p;if(t){d="{{"+e+".";let v=u;i.substring(u).startsWith("}}")&&(v+=2);let b=i.substring(0,I)+d+i.substring(v);p=I+d.length,r._setRawText?r._setRawText(b):pe&&pe(b)}else{d="{{"+e+"}}";let v=u;i.substring(u).startsWith("}}")&&(v+=2);let b=i.substring(0,I)+d+i.substring(v);p=I+d.length,r._setRawText?r._setRawText(b):pe&&pe(b)}if(a?a():gt?.(),ht?.(s,p),t){M(),setTimeout(()=>{ve(s,a||(()=>{}))},0);return}}else{let s=n,r=s.value,i=s.selectionStart??r.length,c,u;if(t){c="{{"+e+".";let d=i;r.substring(i).startsWith("}}")&&(d+=2),s.value=r.substring(0,I)+c+r.substring(d),u=I+c.length}else{c="{{"+e+"}}";let d=i;r.substring(i).startsWith("}}")&&(d+=2),s.value=r.substring(0,I)+c+r.substring(d),u=I+c.length}if(s.selectionStart=u,s.selectionEnd=u,s.focus(),a?a():vt?.(),t){M(),setTimeout(()=>{fe(s,a||(()=>{}))},0);return}}M()}function M(){E&&(E.remove(),E=null),me=null,A=[],P=0,Ve=null}function Y(e){return!E||A.length===0?!1:e.key==="ArrowDown"?(e.preventDefault(),P=(P+1)%A.length,De(),!0):e.key==="ArrowUp"?(e.preventDefault(),P=(P-1+A.length)%A.length,De(),!0):e.key==="Enter"||e.key==="Tab"?(e.preventDefault(),bt(A[P].name),!0):e.key==="Escape"?(e.preventDefault(),M(),!0):!1}function Z(){return E!==null}var ee={},he={},ge=!1,ye=new Set,Et=null,$e=null;function Tt(e){Et=e}function Lt(e){$e=e}function xt(){return ee}function kt(){return he}function Le(){return ge}function Ue(e){ge=e}function wt(){return ye}function D(e){return st(e,{resolved:ee,sources:he,showResolved:ge,secretKeys:ye})}function j(e,t){let n=window.getSelection();if(!n)return;let o=document.createRange(),a=0,s=!1;function r(i){if(i.nodeType===Node.TEXT_NODE){let c=(i.textContent||"").length;if(a+c>=t)return o.setStart(i,t-a),o.collapse(!0),!0;a+=c}else for(let c=0;c<i.childNodes.length;c++)if(r(i.childNodes[c]))return!0;return!1}s=r(e),s||(o.selectNodeContents(e),o.collapse(!1)),n.removeAllRanges(),n.addRange(o)}function _(){document.querySelectorAll(".var-cell").forEach(e=>{let t=e.querySelector('input[type="text"]'),n=e.querySelector(".var-overlay");t&&n&&e.classList.contains("var-overlay-active")&&(n.innerHTML=D(f(t.value)))}),document.querySelectorAll(".val-ce").forEach(e=>{let t=e._getRawText;if(t&&document.activeElement!==e){let n=t();n&&(e.innerHTML=D(f(n)))}})}function te(e){let t=e.parentElement;t.classList.add("var-cell");let n=document.createElement("div");n.className="var-overlay",t.appendChild(n);function o(){n.innerHTML=D(f(e.value))}function a(){t.classList.add("var-overlay-active"),o()}function s(){t.classList.remove("var-overlay-active")}e.addEventListener("input",()=>{o(),fe(e,o)}),e.addEventListener("focus",s),e.addEventListener("blur",()=>{a(),M()}),e.addEventListener("keydown",r=>{Z()&&Y(r)}),n.addEventListener("click",r=>{let i=r.target.closest(".tk-var, .tk-var-resolved");i&&i.dataset.var?W(i,i.dataset.var,{getResolvedVariables:()=>ee,getVariableSources:()=>he,getSecretKeys:()=>ye,postMessage:$e??void 0}):(s(),e.focus())}),document.activeElement!==e&&a()}function Pe(e,t,n){let o=t||"";e._getRawText=()=>o,e._setRawText=s=>{o=s};function a(){if(!o){e.innerHTML="";return}let s=window.getSelection(),r=0;if(s&&s.rangeCount>0&&e.contains(s.anchorNode)){let i=s.getRangeAt(0),c=document.createRange();c.selectNodeContents(e),c.setEnd(i.startContainer,i.startOffset),r=c.toString().length}e.innerHTML=D(f(o)),s&&document.activeElement===e&&j(e,r)}a(),e.addEventListener("input",()=>{if(ge){ge=!1,_(),Et?.();return}let s=window.getSelection(),r=0;if(s&&s.rangeCount>0&&e.contains(s.anchorNode)){let i=s.getRangeAt(0),c=document.createRange();c.selectNodeContents(e),c.setEnd(i.startContainer,i.startOffset),r=c.toString().length}o=e.textContent||"",a(),j(e,r),n(),ve(e,a)}),e.addEventListener("keydown",s=>{Z()&&Y(s)}),e.addEventListener("blur",()=>{M()}),e.addEventListener("click",s=>{let r=s.target.closest(".tk-var, .tk-var-resolved");r&&r.dataset.var&&W(r,r.dataset.var,{getResolvedVariables:()=>ee,getVariableSources:()=>he,getSecretKeys:()=>ye,postMessage:$e??void 0})})}function St(e){if(e.type!=="variablesResolved")return!1;ee=e.variables||{},he=e.sources||{},ut(e.secretProviderNames||[]);let t=e.secretNames||{},n=new Set;for(let[o,a]of Object.entries(t)){pt(o,a);for(let s of a)n.add(`$secret.${o}.${s}`)}return ye=n,_(),!0}var un=null;document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="s"&&un?.()});function Mt(e){ct(()=>ee),yt(()=>{_(),e?.extraSyncHighlight?.()},()=>{_(),e?.extraSyncUrlHighlight?.()},j,e?.setRawUrl)}function At(e){let t=[],n=0;for(;n<e.length;){if(e[n]==='"'){let s=n+1;for(;s<e.length&&e[s]!=='"';)e[s]==="\\"&&s++,s++;s++;let r=e.substring(n,s),i=e.substring(s),u=/^\s*:/.test(i)?"tk-key":"tk-str";t.push("<span class='"+u+"'>"+f(r)+"</span>"),n=s;continue}let o=e.substring(n).match(/^-?\d+\.?\d*(?:e[+-]?\d+)?/i);if(o&&(n===0||/[\s,\[:({]/.test(e[n-1]))){t.push("<span class='tk-num'>"+f(o[0])+"</span>"),n+=o[0].length;continue}let a=e.substring(n).match(/^(true|false|null)\b/);if(a){t.push("<span class='tk-kw'>"+a[0]+"</span>"),n+=a[0].length;continue}t.push(f(e[n])),n++}return t.join("")}function Ht(e){let t=f(e);return t=t.replace(/(&lt;\/?)([\w:-]+)/g,"$1<span class='tk-tag'>$2</span>"),t=t.replace(/([\w:-]+)(=)(")((?:[^"]*))(")/g,"<span class='tk-attr'>$1</span>$2<span class='tk-str'>&quot;$4&quot;</span>"),t}function Ct(e,t){let n;return t==="json"?n=At(e):t==="xml"||t==="html"?n=Ht(e):n=f(e),D(n)}function Rt(e,t){return t==="json"?At(e):t==="xml"||t==="html"?Ht(e):f(e)}function k(e,t,n,o="text"){let a=`<input type="${o}" id="${e}" placeholder="${t}" />`;return n?`<span class="auth-input-wrap">${a}</span>`:a}function It(e,t){let{prefix:n,fieldsContainer:o,onChange:a,wrapInputs:s,showTokenStatus:r}=t;if(o.innerHTML="",e==="bearer")o.innerHTML=`<div class="auth-row"><label>Token</label>${k(n+"Token","{{token}}",s)}</div>`;else if(e==="basic")o.innerHTML=`<div class="auth-row"><label>Username</label>${k(n+"Username","username",s)}</div><div class="auth-row"><label>Password</label>${k(n+"Password","password",s,"password")}</div>`;else if(e==="apikey")o.innerHTML=`<div class="auth-row"><label>Key</label>${k(n+"Key","X-Api-Key",s)}</div><div class="auth-row"><label>Value</label>${k(n+"Value","{{apiKey}}",s)}</div><div class="auth-row"><label>In</label><select id="${n}Placement" class="auth-select"><option value="header">Header</option><option value="query">Query</option></select></div>`;else if(e==="oauth2"){o.innerHTML=`<div class="auth-row"><label>Grant Type</label><select id="${n}OAuth2Flow" class="auth-select"><option value="client_credentials">Client Credentials</option><option value="password">Password</option><option value="authorization_code">Authorization Code</option></select></div><div class="auth-row"><label>Access Token URL</label>${k(n+"OAuth2AccessTokenUrl","{{authUrl}}/token",s)}</div><div class="auth-row"><label>Client ID</label>${k(n+"OAuth2ClientId","{{clientId}}",s)}</div><div class="auth-row"><label>Client Secret</label>${k(n+"OAuth2ClientSecret","{{clientSecret}}",s)}</div><div class="auth-row"><label>Scope</label>${k(n+"OAuth2Scope","openid profile",s)}</div><div id="${n}OAuth2PasswordFields" style="display:none;"><div class="auth-row"><label>Username</label>${k(n+"OAuth2Username","{{username}}",s)}</div><div class="auth-row"><label>Password</label>${k(n+"OAuth2Password","password",s,"password")}</div></div><div id="${n}OAuth2AuthCodeFields" style="display:none;"><div class="auth-row"><label>Auth URL</label>${k(n+"OAuth2AuthorizationUrl","{{authUrl}}/authorize",s)}</div><div class="auth-row"><label>Callback URL</label>${k(n+"OAuth2CallbackUrl","https://localhost/callback",s)}</div></div><div class="auth-row"><label>Refresh URL</label>${k(n+"OAuth2RefreshTokenUrl","(optional)",s)}</div><div class="auth-row"><label>Credentials In</label><select id="${n}OAuth2CredentialsPlacement" class="auth-select"><option value="basic_auth_header">Header</option><option value="body">Body</option></select></div><div class="auth-row"><label>Auto Fetch</label><input type="checkbox" id="${n}OAuth2AutoFetch" checked /></div><div class="auth-row"><label>Auto Refresh</label><input type="checkbox" id="${n}OAuth2AutoRefresh" checked /></div>`+(r?`<div class="oauth2-token-status" id="${n}OAuth2TokenStatus"></div>`:"");let i=document.getElementById(n+"OAuth2Flow"),c=document.getElementById(n+"OAuth2PasswordFields"),u=document.getElementById(n+"OAuth2AuthCodeFields"),d=()=>{let p=i.value;c.style.display=p==="password"?"":"none",u.style.display=p==="authorization_code"?"":"none"};i.addEventListener("change",()=>{d(),a()}),d()}if(o.querySelectorAll("input").forEach(i=>{i.addEventListener("input",a),i.addEventListener("change",a)}),o.querySelectorAll("select").forEach(i=>i.addEventListener("change",a)),t.onFieldsRendered){let i=Array.from(o.querySelectorAll('input[type="text"]'));t.onFieldsRendered(i)}}function qt(e,t){let n=t,o=s=>document.getElementById(s),a=s=>document.getElementById(s);switch(e){case"bearer":return{type:"bearer",token:o(n+"Token")?.value||""};case"basic":return{type:"basic",username:o(n+"Username")?.value||"",password:o(n+"Password")?.value||""};case"apikey":return{type:"apikey",key:o(n+"Key")?.value||"",value:o(n+"Value")?.value||"",placement:a(n+"Placement")?.value||"header"};case"oauth2":{let s=a(n+"OAuth2Flow")?.value||"client_credentials",r={type:"oauth2",flow:s,accessTokenUrl:o(n+"OAuth2AccessTokenUrl")?.value||"",clientId:o(n+"OAuth2ClientId")?.value||"",clientSecret:o(n+"OAuth2ClientSecret")?.value||"",scope:o(n+"OAuth2Scope")?.value||"",refreshTokenUrl:o(n+"OAuth2RefreshTokenUrl")?.value||"",credentialsPlacement:a(n+"OAuth2CredentialsPlacement")?.value||"basic_auth_header",autoFetchToken:o(n+"OAuth2AutoFetch")?.checked!==!1,autoRefreshToken:o(n+"OAuth2AutoRefresh")?.checked!==!1};return s==="password"?(r.username=o(n+"OAuth2Username")?.value||"",r.password=o(n+"OAuth2Password")?.value||""):s==="authorization_code"&&(r.authorizationUrl=o(n+"OAuth2AuthorizationUrl")?.value||"",r.callbackUrl=o(n+"OAuth2CallbackUrl")?.value||""),r.refreshTokenUrl||delete r.refreshTokenUrl,r.scope||delete r.scope,r.clientSecret||delete r.clientSecret,r}case"inherit":return"inherit";default:return}}function Bt(e,t){let n=t,o=s=>document.getElementById(s),a=s=>document.getElementById(s);if(!(!e||e==="inherit")&&!(typeof e!="object"||!e.type))switch(e.type){case"bearer":{let s=o(n+"Token");s&&(s.value=e.token||"");break}case"basic":{let s=o(n+"Username");s&&(s.value=e.username||"");let r=o(n+"Password");r&&(r.value=e.password||"");break}case"apikey":{let s=o(n+"Key");s&&(s.value=e.key||"");let r=o(n+"Value");r&&(r.value=e.value||"");let i=a(n+"Placement");i&&(i.value=e.placement||"header");break}case"oauth2":{let s=a(n+"OAuth2Flow");s&&(s.value=e.flow||"client_credentials",s.dispatchEvent(new Event("change")));let r=o(n+"OAuth2AccessTokenUrl");r&&(r.value=e.accessTokenUrl||"");let i=o(n+"OAuth2ClientId");i&&(i.value=e.clientId||"");let c=o(n+"OAuth2ClientSecret");c&&(c.value=e.clientSecret||"");let u=o(n+"OAuth2Scope");u&&(u.value=e.scope||"");let d=o(n+"OAuth2RefreshTokenUrl");d&&(d.value=e.refreshTokenUrl||"");let p=a(n+"OAuth2CredentialsPlacement");p&&(p.value=e.credentialsPlacement||"basic_auth_header");let v=o(n+"OAuth2AutoFetch");v&&(v.checked=e.autoFetchToken!==!1);let T=o(n+"OAuth2AutoRefresh");if(T&&(T.checked=e.autoRefreshToken!==!1),e.flow==="password"){let b=o(n+"OAuth2Username");b&&(b.value=e.username||"");let w=o(n+"OAuth2Password");w&&(w.value=e.password||"")}else if(e.flow==="authorization_code"){let b=o(n+"OAuth2AuthorizationUrl");b&&(b.value=e.authorizationUrl||"");let w=o(n+"OAuth2CallbackUrl");w&&(w.value=e.callbackUrl||"")}break}}}var pn=[{name:"$select",description:"Choose which properties to return"},{name:"$filter",description:"Filter results based on conditions"},{name:"$orderby",description:"Sort results by properties"},{name:"$top",description:"Limit the number of results"},{name:"$skip",description:"Skip a number of results"},{name:"$count",description:"Include total count of results"},{name:"$expand",description:"Include related entities inline"},{name:"$search",description:"Free-text search expression"},{name:"$format",description:"Response format (json, xml, etc.)"},{name:"$compute",description:"Define computed properties"},{name:"$index",description:"Positional insert index"},{name:"$schemaversion",description:"Target a specific schema version"},{name:"$apply",description:"Aggregation and grouping"},{name:"$skiptoken",description:"Server-driven paging token"},{name:"$deltatoken",description:"Delta tracking token"}],x=null,q=[],F=0,ne=null;function mn(e,t){let n=e.substring(0,t),o=n.lastIndexOf("$");if(o===-1||o>0&&/\w/.test(n[o-1]))return null;let a=n.substring(o);return/^\$[\w]*$/.test(a)?a:null}function Ot(e){let t=e.selectionStart??0,n=mn(e.value,t);if(n===null){se();return}ne=e;let o=n.toLowerCase();if(q=pn.filter(a=>a.name.toLowerCase().startsWith(o)),q.length===0){se();return}F=0,x||(x=document.createElement("div"),x.className="var-autocomplete",document.body.appendChild(x)),_e(),fn(e)}function _e(){x&&(x.innerHTML=q.map((e,t)=>"<div class='"+(t===F?"var-autocomplete-item selected":"var-autocomplete-item")+"' data-index='"+t+"'><span class='var-ac-name'>"+f(e.name)+"</span><span class='var-ac-value'>"+f(e.description)+"</span></div>").join(""),x.querySelectorAll(".var-autocomplete-item").forEach(e=>{e.addEventListener("mousedown",t=>{t.preventDefault();let n=parseInt(e.dataset.index||"0");Dt(q[n].name)})}))}function fn(e){if(!x)return;let t=e.getBoundingClientRect();x.style.left=t.left+"px",x.style.top=t.bottom+2+"px",x.style.minWidth="280px"}function Dt(e){ne&&(ne.value=e,ne.focus(),ne.dispatchEvent(new Event("input",{bubbles:!0})),se())}function se(){x&&(x.remove(),x=null),ne=null,q=[],F=0}function Vt(e){return!x||q.length===0?!1:e.key==="ArrowDown"?(e.preventDefault(),F=(F+1)%q.length,_e(),!0):e.key==="ArrowUp"?(e.preventDefault(),F=(F-1+q.length)%q.length,_e(),!0):e.key==="Enter"||e.key==="Tab"?(e.preventDefault(),Dt(q[F].name),!0):e.key==="Escape"?(e.preventDefault(),se(),!0):!1}function $t(){return x!==null}var Fe=null,Ne="";function Ke(){return Fe}function Pt(){return Ne}function _t(e){l("respLoading").style.display="flex",l("respEmpty").style.display="none",l("respBodyWrap").style.display="none",l("responseBar").style.display="none",l("respTabs").style.display="none",e&&We(e)}function We(e){let t=l("respLoading").querySelector("span");t&&(t.textContent=e)}function je(){l("respLoading").style.display="none"}function Ft(){l("responseBar").style.display="none",l("respTabs").style.display="none",l("respBodyWrap").style.display="none",l("respEmpty").style.display="block",Fe=null,Ne=""}function vn(){l("respLineNumbers").style.display="none"}function gn(e){return e<1024?e+" B":e<1024*1024?(e/1024).toFixed(1)+" KB":(e/(1024*1024)).toFixed(1)+" MB"}function Ut(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}function ze(e,t,n){let o=Date.now();je(),Fe=e,l("sendBtn").classList.remove("sending"),l("sendBtn").disabled=!1,l("sendBtn").textContent="Send",l("responseBar").style.display="flex",l("respTabs").style.display="flex",l("respEmpty").style.display="none",l("respBodyWrap").style.display="block";let a=l("statusBadge");a.textContent=e.status+" "+e.statusText;let s=Math.floor(e.status/100);a.className="status-badge s"+s+"xx";let r=e.body||"",i="";if(e.headers){for(let g of Object.keys(e.headers))if(g.toLowerCase()==="content-type"){i=e.headers[g];break}}let c="text";if(i.includes("json")){c="json";try{r=JSON.stringify(JSON.parse(r),null,2)}catch{}}else i.includes("xml")?c="xml":i.includes("html")&&(c="html");Ne=r;let u=[],d=n&&n.length>0?n[n.length-1].end:0,p=Date.now();console.time("resp:highlight");let T=r.split(`
`).map(g=>'<div class="code-line">'+Rt(g,c)+`
</div>`).join("");console.timeEnd("resp:highlight"),u.push({label:"Highlight",start:d,end:d+(Date.now()-p)}),p=Date.now(),console.time("resp:innerHTML"),l("respBodyPre").innerHTML=T,console.timeEnd("resp:innerHTML"),u.push({label:"DOM Update",start:u[u.length-1].end,end:d+(Date.now()-o)}),p=Date.now(),console.time("resp:lineNumbers"),vn(),console.timeEnd("resp:lineNumbers"),u.push({label:"Line Numbers",start:u[u.length-1].end,end:d+(Date.now()-o)}),p=Date.now();let b=l("respHeadersBody");b.innerHTML="",e.headers&&Object.entries(e.headers).forEach(([g,m])=>{let U=document.createElement("tr");U.innerHTML="<td>"+Ut(g)+"</td><td>"+Ut(String(m))+"</td>",b.appendChild(U)}),u.push({label:"Headers",start:u[u.length-1].end,end:d+(Date.now()-o)});let w=Date.now()-o,N=e.duration+"ms";t!==void 0&&(N=t+"ms pre \u2022 "+e.duration+"ms response \u2022 "+w+"ms render");let $=l("responseMeta");$.textContent=N+" \u2022 "+gn(e.size);let y=document.getElementById("timingTooltip");y&&y.remove(),$.classList.remove("has-timing");let C=[...n??[],...u];if(C.length>0){let g=C[C.length-1].end,m=document.createElement("div");m.id="timingTooltip",m.className="timing-tooltip";let U={"OAuth2 Resolve":"#e8a838","OAuth2 Token":"#e87838","Resolve Variables":"#5b9bd5","Interpolate + Params":"#7bc67e",Auth:"#c678dd",Body:"#56b6c2",Secrets:"#d19a66",HTTP:"#61afef",Highlight:"#98c379","DOM Update":"#e06c75","Line Numbers":"#c678dd",Headers:"#56b6c2"};for(let B of C){let Ae=B.end-B.start;if(Ae<1&&B.label!=="HTTP")continue;let tn=g>0?B.start/g*100:0,nn=g>0?Math.max(Ae/g*100,1):0,sn=U[B.label]||"#888",ie=document.createElement("div");ie.className="timing-row";let He=document.createElement("span");He.className="timing-label",He.textContent=B.label;let Ce=document.createElement("div");Ce.className="timing-track";let ce=document.createElement("div");ce.className="timing-bar",ce.style.left=tn+"%",ce.style.width=nn+"%",ce.style.background=sn;let Re=document.createElement("span");Re.className="timing-dur",Re.textContent=Ae+"ms",Ce.appendChild(ce),ie.appendChild(He),ie.appendChild(Ce),ie.appendChild(Re),m.appendChild(ie)}let Me=document.createElement("div");Me.className="timing-row timing-total",Me.innerHTML='<span class="timing-label">Total</span><div class="timing-track"></div><span class="timing-dur">'+g+"ms</span>",m.appendChild(Me),document.body.appendChild(m),$.classList.add("has-timing"),$.onmouseenter=()=>{let B=$.getBoundingClientRect();m.style.display="block",m.style.position="fixed",m.style.left=Math.max(0,B.right-m.offsetWidth)+"px",m.style.top=B.top-m.offsetHeight-8+"px"},$.onmouseleave=()=>{m.style.display="none"}}}function h(){z&&clearTimeout(z),qe(setTimeout(()=>{be(!0);let e=Se();S.postMessage({type:"updateDocument",request:e})},300))}var hn=["body","auth","headers","params","settings"],yn=["resp-body","resp-headers"];function Wt(e,t,n){e.querySelectorAll(".tab").forEach(a=>a.classList.remove("active"));let o=e.querySelector(`[data-tab="${t}"]`);o&&o.classList.add("active"),n.forEach(a=>{let s=document.getElementById("panel-"+a);s&&s.classList.toggle("active",a===t)})}l("reqTabs").querySelectorAll(".tab").forEach(e=>{e.addEventListener("click",()=>{Wt(l("reqTabs"),e.dataset.tab,hn)})});l("respTabs").querySelectorAll(".tab").forEach(e=>{e.addEventListener("click",()=>{Wt(l("respTabs"),e.dataset.tab,yn)})});var Ge=l("divider"),Nt=l("requestSection"),Kt=l("responseSection"),Ye=!1;Ge.addEventListener("mousedown",()=>{Ye=!0,Ge.classList.add("dragging"),document.body.style.cursor="ns-resize",document.body.style.userSelect="none"});document.addEventListener("mousemove",e=>{if(!Ye)return;let n=document.querySelector(".main-content").getBoundingClientRect(),o=e.clientY-n.top,a=n.height,s=Math.max(15,Math.min(85,o/a*100));Nt.style.flex="none",Nt.style.height=s+"%",Kt.style.flex="none",Kt.style.height=100-s+"%"});document.addEventListener("mouseup",()=>{Ye=!1,Ge.classList.remove("dragging"),document.body.style.cursor="",document.body.style.userSelect=""});var re=l("method");function jt(){re.className="method-select "+re.value.toLowerCase()}re.addEventListener("change",()=>{jt(),h(),S.postMessage({type:"methodChanged",method:re.value})});var Xe=!1;function ke(e="",t="",n="query",o=!1){let a=l("paramsBody"),s=document.createElement("tr");s.innerHTML='<td><input type="checkbox" class="p-enabled" '+(o?"":"checked")+' /></td><td><input type="text" class="p-name" value="'+J(e)+'" placeholder="name" /></td><td class="val-cell"><div class="val-ce p-value" contenteditable="true" data-placeholder="value"></div></td><td><select class="p-type select-borderless"><option value="query"'+(n==="query"?" selected":"")+'>query</option><option value="path"'+(n==="path"?" selected":"")+'>path</option></select></td><td><button class="row-delete">\xD7</button></td>',s.querySelector(".row-delete").addEventListener("click",()=>{s.remove(),le(),ae(),h()}),s.querySelector(".p-enabled").addEventListener("change",()=>{ae(),h()}),s.querySelector(".p-type").addEventListener("change",()=>{ae(),h()});let c=s.querySelector(".p-name");te(c),c.addEventListener("input",()=>{Ot(c),ae(),h()}),c.addEventListener("keydown",u=>{$t()&&Vt(u)}),c.addEventListener("blur",()=>se()),Pe(s.querySelector(".p-value"),t,()=>{ae(),h()}),a.appendChild(s),le()}function zt(){let e=we,t=[];return document.querySelectorAll("#paramsBody tr").forEach(n=>{let o=n.querySelector(".p-enabled").checked,a=n.querySelector(".p-type").value;if(!o||a!=="query")return;let s=n.querySelector(".p-name").value,r=n.querySelector(".p-value"),i=r._getRawText?r._getRawText():r.textContent||"";s&&t.push(s+"="+i)}),t.length>0&&(e+="?"+t.join("&")),e}function ae(){Xe||V()}function Gt(e){Xe=!0;let t=e.indexOf("?"),n=t>=0?e.substring(0,t):e,o=t>=0?e.substring(t+1):"";we=n;let a=[];if(o)for(let d of o.split("&")){let p=d.indexOf("=");p>=0?a.push({name:d.substring(0,p),value:d.substring(p+1)}):d&&a.push({name:d,value:""})}let s=Array.from(document.querySelectorAll("#paramsBody tr")),r=[],i=[];for(let d of s)if(d.querySelector(".p-type").value==="query"){let v=d.querySelector(".p-name").value,T=d.querySelector(".p-value"),b=T._getRawText?T._getRawText():T.textContent||"",w=d.querySelector(".p-enabled").checked;r.push({tr:d,name:v,value:b,enabled:w})}else i.push(d);let c=l("paramsBody");for(let d of r)d.tr.remove();let u=r.filter(d=>!d.enabled);for(let d of a)ke(d.name,d.value,"query",!1);for(let d of u)ke(d.name,d.value,"query",!0);for(let d of i)c.appendChild(d);le(),Xe=!1}function Xt(e="",t="",n=!1){let o=l("headersBody"),a=document.createElement("tr");a.innerHTML='<td><input type="checkbox" class="h-enabled" '+(n?"":"checked")+' /></td><td><input type="text" class="h-name" value="'+J(e)+'" placeholder="name" /></td><td class="val-cell"><div class="val-ce h-value" contenteditable="true" data-placeholder="value"></div></td><td><button class="row-delete">\xD7</button></td>',a.querySelector(".row-delete").addEventListener("click",()=>{a.remove(),le(),h()}),a.addEventListener("change",h);let s=a.querySelector(".h-name");te(s),s.addEventListener("input",h),Pe(a.querySelector(".h-value"),t,h),o.appendChild(a),le()}function Jt(){Ue(!1),l("varToggleBtn").classList.remove("active"),H(),V(),_()}function Qt(e="",t="",n=!1){let o=l("bodyFormBody"),a=document.createElement("tr");a.innerHTML='<td><input type="checkbox" class="f-enabled" '+(n?"":"checked")+' /></td><td><input type="text" class="f-name" value="'+J(e)+'" placeholder="name" /></td><td><input type="text" class="f-value" value="'+J(t)+'" placeholder="value" /></td><td><button class="row-delete">\xD7</button></td>',a.querySelector(".row-delete").addEventListener("click",()=>{a.remove(),h()}),a.addEventListener("input",h),a.addEventListener("change",h),te(a.querySelector(".f-name")),te(a.querySelector(".f-value")),o.appendChild(a)}function le(){let e=document.querySelectorAll("#paramsBody tr"),t=document.querySelectorAll("#headersBody tr");l("paramsBadge").textContent=String(e.length),l("headersBadge").textContent=String(t.length)}function xe(e){tt(e),document.querySelectorAll("#bodyTypePills .pill").forEach(a=>{a.classList.toggle("active",a.dataset.bodyType===e)});let t=l("bodyRawEditor"),n=l("bodyFormEditor"),o=l("bodyLangMode");e==="none"?(t.style.display="none",n.style.display="none",o.style.display="none"):e==="form-urlencoded"||e==="multipart-form"?(t.style.display="none",n.style.display="block",o.style.display="none"):(t.style.display="flex",t.style.flexDirection="column",t.style.flex="1",n.style.display="none",o.style.display="block")}document.querySelectorAll("#bodyTypePills .pill").forEach(e=>{e.addEventListener("click",()=>{xe(e.dataset.bodyType)})});function Yt(){let e=l("bodyData"),t=l("lineNumbers"),o=l("bodyHighlight").querySelectorAll(":scope > .code-line"),a=o.length||1;if(t.children.length!==a){let i="";for(let c=1;c<=a;c++)i+="<span>"+c+"</span>";t.innerHTML=i}let r=t.children;for(let i=0;i<r.length;i++){let c=o[i];c&&(r[i].style.height=c.offsetHeight+"px")}t.style.top=-e.scrollTop+"px"}function H(){try{let e=l("bodyData"),t=l("bodyHighlight"),n=e.value.split(`
`);t.innerHTML=n.map(o=>'<div class="code-line">'+Ct(o,X)+`
</div>`).join(""),Yt()}catch{}}function Ze(){return{getResolvedVariables:xt,getVariableSources:kt,getSecretKeys:wt,postMessage:e=>S.postMessage(e),onEditVariable:e=>S.postMessage({type:"editVariable",variableName:e})}}l("bodyHighlight").addEventListener("click",e=>{let t=e.target.closest(".tk-var, .tk-var-resolved");t&&t.dataset.var&&W(t,t.dataset.var,Ze())});var we="";function bn(){return we}function En(e){we=e,V()}function V(){let e=l("url"),t=zt();if(!t){e.innerHTML="";return}let n=window.getSelection(),o=0;if(n&&n.rangeCount>0&&e.contains(n.anchorNode)){let a=n.getRangeAt(0),s=document.createRange();s.selectNodeContents(e),s.setEnd(a.startContainer,a.startOffset),o=s.toString().length}e.innerHTML=D(f(t)),n&&document.activeElement===e&&j(e,o)}Mt({extraSyncHighlight:H,extraSyncUrlHighlight:V,setRawUrl:e=>{Gt(e)}});Lt(e=>S.postMessage(e));Tt(()=>{l("varToggleBtn").classList.remove("active"),H(),V()});l("url").addEventListener("click",e=>{let t=e.target.closest(".tk-var, .tk-var-resolved");t&&t.dataset.var&&W(t,t.dataset.var,Ze())});l("url").addEventListener("input",()=>{if(Le()){Jt(),j(l("url"),zt().length);return}let e=l("url"),t=window.getSelection(),n=0;if(t&&t.rangeCount>0&&e.contains(t.anchorNode)){let a=t.getRangeAt(0),s=document.createRange();s.selectNodeContents(e),s.setEnd(a.startContainer,a.startOffset),n=s.toString().length}let o=e.textContent||"";Gt(o),V(),j(e,n),ve(e,V),h()});function Tn(){let e=l("bodyData"),t=l("bodyHighlight");t.scrollTop=e.scrollTop,t.scrollLeft=e.scrollLeft,Yt()}l("bodyData").addEventListener("input",()=>{Le()&&Jt(),H(),fe(l("bodyData"),H),h()});l("bodyData").addEventListener("scroll",Tn);l("bodyData").addEventListener("click",e=>{let t=e,n=l("bodyData");n.style.pointerEvents="none";let o=document.elementFromPoint(t.clientX,t.clientY);if(n.style.pointerEvents="",o){let a=o.closest(".tk-var");a&&a.dataset.var&&W(a,a.dataset.var,Ze())}});l("bodyData").addEventListener("keydown",e=>{Z()&&Y(e)});l("url").addEventListener("keydown",e=>{if(Z()){Y(e);return}e.key==="Enter"&&e.preventDefault()});l("bodyData").addEventListener("blur",()=>{setTimeout(M,150)});l("url").addEventListener("blur",()=>{setTimeout(M,150)});var Ln={prefix:"auth",get fieldsContainer(){return l("authFields")},onChange:()=>h(),showInherit:!0,wrapInputs:!0,showTokenStatus:!0,onFieldsRendered:e=>e.forEach(te)};function Zt(){let e=l("authType").value;It(e,Ln)}function Je(){let e=l("oauth2Flow")?.value||"client_credentials",t={type:"oauth2",flow:e,accessTokenUrl:L("oauth2AccessTokenUrl")?.value||"",clientId:L("oauth2ClientId")?.value||"",clientSecret:L("oauth2ClientSecret")?.value||"",scope:L("oauth2Scope")?.value||"",refreshTokenUrl:L("oauth2RefreshTokenUrl")?.value||"",credentialsPlacement:l("oauth2CredentialsPlacement")?.value||"basic_auth_header",credentialsId:K?.http?.auth?.credentialsId,autoFetchToken:l("oauth2AutoFetch")?.checked!==!1,autoRefreshToken:l("oauth2AutoRefresh")?.checked!==!1};return e==="password"&&(t.username=L("oauth2Username")?.value||"",t.password=L("oauth2Password")?.value||""),t}function Qe(){if(l("authType")?.value!=="oauth2")return;let e=Je();e.accessTokenUrl&&S.postMessage({type:"getTokenStatus",auth:e})}function xn(e){if(e<=0)return"expired";let t=Math.floor(e/1e3);if(t<60)return`${t}s`;let n=Math.floor(t/60);return n<60?`${n}m ${t%60}s`:`${Math.floor(n/60)}h ${n%60}m`}var oe=null;function kn(e){let t=document.getElementById("oauth2TokenStatus");if(!t)return;if(oe&&(clearInterval(oe),oe=null),!e.hasToken){t.innerHTML='<div class="token-status token-none"><span class="token-dot dot-none"></span> No token<button class="token-btn" id="oauth2GetTokenBtn">Get Token</button></div>',t.querySelector("#oauth2GetTokenBtn")?.addEventListener("click",()=>{let o=Je();S.postMessage({type:"getToken",auth:o})});return}let n=()=>{let o=Date.now(),a=e.expiresAt?e.expiresAt-o:void 0,s=a!==void 0&&a<=0,r=s?"dot-expired":"dot-valid",i=s?"Expired":a!==void 0?`Expires in ${xn(a)}`:"Valid (no expiry)",c=e.expiresAt?new Date(e.expiresAt).toLocaleTimeString():"";t.innerHTML='<div class="token-status '+(s?"token-expired":"token-valid")+'"><span class="token-dot '+r+'"></span> '+i+(c?'<span class="token-expiry-time"> ('+c+")</span>":"")+'<button class="token-btn" id="oauth2RefreshTokenBtn">'+(s?"Get Token":"Refresh")+"</button></div>",t.querySelector("#oauth2RefreshTokenBtn")?.addEventListener("click",()=>{let u=Je();S.postMessage({type:"getToken",auth:u})})};n(),e.expiresAt&&(oe=setInterval(()=>{n(),e.expiresAt&&Date.now()>e.expiresAt&&(clearInterval(oe),oe=null)},1e3))}function wn(e){let t=document.getElementById("oauth2TokenStatus");if(t&&e){let n=e.startsWith("Error:");t.innerHTML='<div class="token-status '+(n?"token-error":"token-progress")+'">'+(n?'<span class="token-dot dot-expired"></span> ':'<span class="token-spinner"></span> ')+J(e)+"</div>"}}function Se(){let e=K?JSON.parse(JSON.stringify(K)):{};e.info||(e.info={type:"http"}),e.http||(e.http={}),e.settings||(e.settings={}),e.http.method=re.value,e.http.url=bn();let t=[];document.querySelectorAll("#paramsBody tr").forEach(s=>{t.push({name:s.querySelector(".p-name").value,value:s.querySelector(".p-value")._getRawText?s.querySelector(".p-value")._getRawText():s.querySelector(".p-value").textContent||"",type:s.querySelector(".p-type").value,disabled:!s.querySelector(".p-enabled").checked})}),e.http.params=t;let n=[];if(document.querySelectorAll("#headersBody tr").forEach(s=>{n.push({name:s.querySelector(".h-name").value,value:s.querySelector(".h-value")._getRawText?s.querySelector(".h-value")._getRawText():s.querySelector(".h-value").textContent||"",disabled:!s.querySelector(".h-enabled").checked})}),e.http.headers=n,G!=="none")if(G==="form-urlencoded"||G==="multipart-form"){let s=[];document.querySelectorAll("#bodyFormBody tr").forEach(r=>{s.push({name:r.querySelector(".f-name").value,value:r.querySelector(".f-value").value,disabled:!r.querySelector(".f-enabled").checked})}),e.http.body={type:G,data:s}}else e.http.body={type:X,data:l("bodyData").value};else delete e.http.body;let o=l("authType").value,a=qt(o,"auth");return a!==void 0?e.http.auth=a:delete e.http.auth,e.settings.timeout=parseInt(L("settingTimeout").value)||3e4,e.settings.encodeUrl=L("settingEncodeUrl").checked,e.settings.followRedirects=L("settingFollowRedirects").checked,e.settings.maxRedirects=parseInt(L("settingMaxRedirects").value)||5,e}function en(){let e=Se();l("sendBtn").classList.add("sending"),l("sendBtn").disabled=!0,l("sendBtn").textContent="Sending...",_t(),S.postMessage({type:"sendRequest",request:e})}function Sn(){z&&(clearTimeout(z),qe(null)),be(!0);let e=Se();S.postMessage({type:"saveDocument",request:e})}function Mn(e){et(e),l("exampleIndicator").style.display="none";let t=e.http||{};re.value=(t.method||"GET").toUpperCase(),jt(),l("paramsBody").innerHTML="",(t.params||[]).forEach(r=>ke(r.name,r.value,r.type||"query",r.disabled));let n=t.url||"";if((t.params||[]).some(r=>(r.type||"query")==="query")&&n.includes("?")&&(n=n.split("?")[0]),En(n),l("headersBody").innerHTML="",(t.headers||[]).forEach(r=>Xt(r.name,r.value,r.disabled)),t.body){let r=Array.isArray(t.body)?(t.body.find(i=>i.selected)||t.body[0])?.body:t.body;r&&(r.type==="form-urlencoded"||r.type==="multipart-form"?(xe(r.type),l("bodyFormBody").innerHTML="",(r.data||[]).forEach(i=>Qt(i.name,i.value,i.disabled))):(xe("raw"),Ee(r.type||"json"),l("bodyLangMode").value=X,r.data&&(l("bodyData").value=r.data),H()))}else xe("none");let a=t.auth;a==="inherit"?l("authType").value="inherit":a&&a.type?l("authType").value=a.type:l("authType").value="none",Zt(),a&&a!=="inherit"&&a.type&&setTimeout(()=>{Bt(a,"auth"),_(),Qe()},0);let s=e.settings||{};L("settingTimeout").value=s.timeout!==void 0&&s.timeout!=="inherit"?s.timeout:"30000",L("settingEncodeUrl").checked=s.encodeUrl!==void 0&&s.encodeUrl!=="inherit"?s.encodeUrl:!0,L("settingFollowRedirects").checked=s.followRedirects!==void 0&&s.followRedirects!=="inherit"?s.followRedirects:!0,L("settingMaxRedirects").value=s.maxRedirects!==void 0&&s.maxRedirects!=="inherit"?s.maxRedirects:"5",le()}window.addEventListener("message",e=>{let t=e.data;switch(t.type){case"requestLoaded":if(Ie){be(!1);break}Mn(t.request);break;case"response":l("exampleIndicator").style.display="none",ze(t.response,t.preRequestMs,t.timing),Qe();break;case"sending":l("sendBtn").classList.add("sending"),l("sendBtn").disabled=!0,l("sendBtn").textContent="Sending...",t.message&&We(t.message);break;case"saved":break;case"error":je(),l("sendBtn").classList.remove("sending"),l("sendBtn").disabled=!1,l("sendBtn").textContent="Send";break;case"languageChanged":Ee(t.language),l("bodyLangMode").value=X,H();break;case"bodyUpdated":l("bodyData").value=t.content,H();break;case"examplesUpdated":K&&(K.examples=t.examples||[]);break;case"loadExample":{let n=t.example;if(n.response){let a={};if(n.response.headers)for(let s of n.response.headers)a[s.name]=s.value;ze({status:n.response.status,statusText:n.response.statusText,headers:a,body:n.response.body?.data??"",duration:0,size:(n.response.body?.data??"").length})}let o=l("exampleIndicator");o.textContent=t.exampleName||"Example",o.style.display="inline-block";break}case"clearExample":Ft(),l("exampleIndicator").style.display="none";break;case"variablesResolved":{St(t),H(),V(),Qe();break}case"secretValueResolved":lt(t);break;case"oauth2TokenStatus":kn(t.status);break;case"oauth2Progress":wn(t.message);break}});l("varToggleBtn").addEventListener("click",()=>{let e=!Le();Ue(e),l("varToggleBtn").classList.toggle("active",e),H(),V(),_()});l("sendBtn").addEventListener("click",en);document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="Enter"&&(e.preventDefault(),en())});l("copyRespBtn").addEventListener("click",()=>{let e=Pt();e&&navigator.clipboard.writeText(e).then(()=>{let t=l("copyRespBtn");t.textContent="Copied!",setTimeout(()=>{t.textContent="Copy"},1500)})});l("saveExampleBtn").addEventListener("click",()=>{if(!Ke())return;let e=Se();S.postMessage({type:"saveExample",request:e,response:Ke()})});l("addParamBtn").addEventListener("click",()=>{ke(),ae()});l("addHeaderBtn").addEventListener("click",()=>Xt());l("addFormFieldBtn").addEventListener("click",()=>Qt());l("authType").addEventListener("change",()=>{Zt(),h()});l("panel-auth").addEventListener("input",h);l("panel-auth").addEventListener("change",h);l("panel-settings").addEventListener("input",h);l("panel-settings").addEventListener("change",h);l("bodyLangMode").addEventListener("change",()=>{Ee(l("bodyLangMode").value),H(),h()});document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="s"&&(e.preventDefault(),Sn())});S.postMessage({type:"ready"});})();

"use strict";(()=>{var T=acquireVsCodeApi(),c=null,E=!1,g=!1,u=-1,y=null;function a(e){return document.getElementById(e)}function f(e){if(!e)return"";let n=document.createElement("div");return n.textContent=e,n.innerHTML}function r(){g||(y&&clearTimeout(y),y=setTimeout(()=>{c&&A()},400))}function A(){let e=JSON.parse(JSON.stringify(c));e.info=e.info||{},e.info.name=a("infoName").value||void 0,e.info.version=a("infoVersion").value||void 0;let n=a("infoSummary").value;n?e.info.summary=n:delete e.info.summary;let t=[];document.querySelectorAll("#defaultHeadersBody tr").forEach(i=>{let o=i.querySelectorAll('input[type="text"]'),d=i.querySelector('input[type="checkbox"]');if(o[0]?.value){let p={name:o[0].value,value:o[1]?.value||""};d&&!d.checked&&(p.disabled=!0),t.push(p)}}),e.request||(e.request={}),e.request.headers=t.length>0?t:void 0;let s=a("defaultAuthType").value;s==="bearer"?e.request.auth={type:"bearer",token:a("dAuthToken")?.value||""}:s==="basic"?e.request.auth={type:"basic",username:a("dAuthUser")?.value||"",password:a("dAuthPass")?.value||""}:s==="apikey"?e.request.auth={type:"apikey",key:a("dAuthKey")?.value||"",value:a("dAuthValue")?.value||""}:delete e.request.auth;let l=[];document.querySelectorAll("#defaultVarsBody tr").forEach(i=>{let o=i.querySelectorAll('input[type="text"]'),d=i.querySelector('input[type="checkbox"]');if(o[0]?.value){let p={name:o[0].value,value:o[1]?.value||""};d&&!d.checked&&(p.disabled=!0),l.push(p)}}),e.request=e.request||{},e.request.variables=l.length>0?l:void 0,e.request&&Object.keys(e.request).every(i=>e.request[i]===void 0)&&delete e.request,E=!0,T.postMessage({type:"updateDocument",collection:e})}function k(e){let n=a(e);n&&n.querySelectorAll(".tab").forEach(t=>{t.addEventListener("click",()=>{let s=t.dataset.tab;n.querySelectorAll(".tab").forEach(o=>o.classList.remove("active")),t.classList.add("active");let l=n.parentElement;l.querySelectorAll(":scope > .tab-content > .tab-panel").forEach(o=>o.classList.remove("active"));let i=l.querySelector(`#panel-${s}`);i&&i.classList.add("active")})})}function w(e){let n=a("defaultHeadersBody");n.innerHTML="",(e||[]).forEach(t=>x(t.name,t.value,t.disabled))}function x(e,n,t){let s=a("defaultHeadersBody"),l=document.createElement("tr");l.innerHTML=`<td><input type="checkbox" ${t?"":"checked"} /></td><td><input type="text" value="${f(e||"")}" placeholder="Header name" /></td><td><input type="text" value="${f(n||"")}" placeholder="Header value" /></td><td><button class="row-delete">\xD7</button></td>`,l.querySelector(".row-delete").addEventListener("click",()=>{l.remove(),r()}),l.querySelectorAll("input").forEach(i=>{i.addEventListener("input",r),i.addEventListener("change",r)}),s.appendChild(l)}function C(e){let n=a("defaultVarsBody");n.innerHTML="",(e||[]).forEach(t=>H(t.name,t.value,t.disabled))}function H(e,n,t){let s=a("defaultVarsBody"),l=document.createElement("tr"),i=typeof n=="string"?n:n&&n.data?n.data:"";l.innerHTML=`<td><input type="checkbox" ${t?"":"checked"} /></td><td><input type="text" value="${f(e||"")}" placeholder="Variable name" /></td><td><input type="text" value="${f(i)}" placeholder="Variable value" /></td><td><button class="row-delete">\xD7</button></td>`,l.querySelector(".row-delete").addEventListener("click",()=>{l.remove(),r()}),l.querySelectorAll("input").forEach(o=>{o.addEventListener("input",r),o.addEventListener("change",r)}),s.appendChild(l)}function L(){let e=a("defaultAuthType").value,n=a("defaultAuthFields");n.innerHTML="",e==="bearer"?n.innerHTML='<div class="auth-row"><label>Token</label><input type="text" id="dAuthToken" placeholder="{{token}}" /></div>':e==="basic"?n.innerHTML='<div class="auth-row"><label>Username</label><input type="text" id="dAuthUser" /></div><div class="auth-row"><label>Password</label><input type="password" id="dAuthPass" /></div>':e==="apikey"&&(n.innerHTML='<div class="auth-row"><label>Key</label><input type="text" id="dAuthKey" placeholder="X-Api-Key" /></div><div class="auth-row"><label>Value</label><input type="text" id="dAuthValue" placeholder="{{apiKey}}" /></div>'),n.querySelectorAll("input").forEach(t=>t.addEventListener("input",r)),r()}var S=[{token:"charts.red",hex:"var(--vscode-charts-red, #f14c4c)"},{token:"charts.orange",hex:"var(--vscode-charts-orange, #d18616)"},{token:"charts.yellow",hex:"var(--vscode-charts-yellow, #cca700)"},{token:"charts.green",hex:"var(--vscode-charts-green, #89d185)"},{token:"charts.blue",hex:"var(--vscode-charts-blue, #3794ff)"},{token:"charts.purple",hex:"var(--vscode-charts-purple, #b180d7)"},{token:"charts.foreground",hex:"var(--vscode-charts-foreground, #cccccc)"},{token:"terminal.ansiRed",hex:"var(--vscode-terminal-ansiRed, #cd3131)"},{token:"terminal.ansiGreen",hex:"var(--vscode-terminal-ansiGreen, #0dbc79)"},{token:"terminal.ansiYellow",hex:"var(--vscode-terminal-ansiYellow, #e5e510)"},{token:"terminal.ansiBlue",hex:"var(--vscode-terminal-ansiBlue, #2472c8)"},{token:"terminal.ansiMagenta",hex:"var(--vscode-terminal-ansiMagenta, #bc3fbc)"},{token:"terminal.ansiCyan",hex:"var(--vscode-terminal-ansiCyan, #11a8cd)"},{token:"terminal.ansiWhite",hex:"var(--vscode-terminal-ansiWhite, #e5e5e5)"}];function m(){let e=a("envSelector");e.innerHTML="";let n=c?.config?.environments||[];if(n.length===0){let t=document.createElement("option");t.value="-1",t.textContent="No environments",e.appendChild(t),e.disabled=!0}else e.disabled=!1,n.forEach((t,s)=>{let l=document.createElement("option");l.value=String(s),l.textContent=t.name||"Unnamed",e.appendChild(l)}),e.value=String(u)}function M(e){u=e,m(),h()}function B(){let e=c?.config?.environments||[];u<0||u>=e.length||(e.splice(u,1),u>=e.length&&(u=e.length-1),m(),h(),r())}function V(){c.config||(c.config={}),c.config.environments||(c.config.environments=[]),c.config.environments.push({name:"new-environment",variables:[]}),u=c.config.environments.length-1,m(),h(),r()}function b(){let e=document.querySelector(".swatch-popover");e&&e.remove()}function I(e,n){b();let t=document.createElement("div");t.className="swatch-popover",S.forEach(l=>{let i=document.createElement("button");i.className="color-swatch"+(l.token===n.color?" active":""),i.style.background=l.hex,i.addEventListener("click",o=>{o.stopPropagation(),n.color=l.token,b(),m(),h(),r()}),t.appendChild(i)});let s=e.getBoundingClientRect();t.style.top=s.bottom+4+"px",t.style.left=s.left+"px",document.body.appendChild(t),setTimeout(()=>{document.addEventListener("click",function l(){b(),document.removeEventListener("click",l)})},0)}function h(){let e=a("envDetail"),n=c?.config?.environments||[];if(u<0||u>=n.length){e.innerHTML='<div class="env-detail-empty">Add an environment to get started</div>';return}let t=n[u],s=t.color||"",l=S.find(d=>d.token===s),i=l?l.hex:"var(--vscode-charts-foreground, #888)";e.innerHTML='<div class="env-meta"><button class="color-dot-btn" id="envColorBtn" style="background:'+i+'" title="Pick color"></button><div class="form-field name"><label>Name</label><input type="text" id="envName" value="'+f(t.name)+'" /></div><div class="form-field extends"><label>Extends</label><input type="text" id="envExtends" value="'+f(t.extends||"")+'" placeholder="parent env name" /></div></div><div class="tabs" id="envTabs"><div class="tab active" data-tab="env-vars">Variables <span class="badge" id="envVarsBadge">'+(t.variables?t.variables.length:0)+'</span></div><div class="tab" data-tab="env-settings">Settings</div></div><div class="tab-content"><div class="tab-panel active" id="panel-env-vars"><table class="kv-table"><thead><tr><th></th><th>Name</th><th>Value</th><th>Type</th><th></th></tr></thead><tbody id="envVarsBody"></tbody></table><button class="add-row-btn" id="addEnvVarBtn">+ Add Variable</button></div><div class="tab-panel" id="panel-env-settings"><div class="auth-section"><div class="auth-row"><label>dotenv File</label><input type="text" id="envDotenv" value="'+f(t.dotEnvFilePath||"")+'" placeholder=".env.local" /></div></div></div></div>',a("envName").addEventListener("input",()=>{t.name=a("envName").value,m(),r()}),a("envColorBtn").addEventListener("click",d=>{d.stopPropagation(),I(a("envColorBtn"),t)}),a("envExtends").addEventListener("input",()=>{let d=a("envExtends").value;d?t.extends=d:delete t.extends,r()}),a("envDotenv")?.addEventListener("input",()=>{let d=a("envDotenv").value;d?t.dotEnvFilePath=d:delete t.dotEnvFilePath,r()});let o=a("envVarsBody");(t.variables||[]).forEach((d,p)=>{N(o,t,p)}),a("addEnvVarBtn").addEventListener("click",()=>{t.variables||(t.variables=[]),t.variables.push({name:"",value:""}),h(),r()}),k("envTabs")}function N(e,n,t){let s=n.variables[t],l=document.createElement("tr"),i=s.secret===!0,o=s.disabled?"":"checked",d=i?s.value||"":typeof s.value=="string"?s.value:s.value&&s.value.data?s.value.data:"";l.innerHTML=`<td><input type="checkbox" ${o} data-field="disabled" /></td><td><input type="text" value="${f(s.name||"")}" data-field="name" /></td><td>${i?'<div class="secret-value-wrap"><input type="password" value="'+f(d)+'" data-field="value" /><button class="secret-toggle" title="Show/hide">&#9673;</button></div>':'<input type="text" value="'+f(d)+'" data-field="value" />'}</td><td><select class="type-select" data-field="type"><option value="var"${i?"":" selected"}>var</option><option value="secret"${i?" selected":""}>secret</option></select></td><td><button class="row-delete">\xD7</button></td>`,l.querySelectorAll("input[data-field]").forEach(v=>{let q=v.dataset.field;v.type==="checkbox"?v.addEventListener("change",()=>{n.variables[t].disabled=!v.checked,r()}):v.addEventListener("input",()=>{n.variables[t][q]=v.value,r()})});let p=l.querySelector(".type-select");p?.addEventListener("change",()=>{p.value==="secret"?n.variables[t].secret=!0:delete n.variables[t].secret,h(),r()}),l.querySelector(".secret-toggle")?.addEventListener("click",()=>{let v=l.querySelector('input[data-field="value"]');v&&(v.type=v.type==="password"?"text":"password")}),l.querySelector(".row-delete")?.addEventListener("click",()=>{n.variables.splice(t,1),h(),r()}),e.appendChild(l)}function $(e){g=!0,c=JSON.parse(JSON.stringify(e)),a("collectionName").textContent=e.info?.name||"Collection",a("infoName").value=e.info?.name||"",a("infoVersion").value=e.info?.version||"",a("infoSummary").value=e.info?.summary||"",w(e.request?.headers||[]),C(e.request?.variables||[]);let n=e.request?.auth;n&&typeof n=="object"&&n.type?(a("defaultAuthType").value=n.type,L(),setTimeout(()=>{if(n.type==="bearer"){let s=a("dAuthToken");s&&(s.value=n.token||"")}if(n.type==="basic"){let s=a("dAuthUser");s&&(s.value=n.username||"");let l=a("dAuthPass");l&&(l.value=n.password||"")}if(n.type==="apikey"){let s=a("dAuthKey");s&&(s.value=n.key||"");let l=a("dAuthValue");l&&(l.value=n.value||"")}},0)):(a("defaultAuthType").value="none",L()),a("headersBadge").textContent=String((e.request?.headers||[]).length),a("variablesBadge").textContent=String((e.request?.variables||[]).length);let t=c?.config?.environments||[];a("envBadge").textContent=String(t.length),u<0&&t.length>0&&(u=0),u>=t.length&&(u=t.length-1),m(),h(),setTimeout(()=>{g=!1},50)}window.addEventListener("message",e=>{let n=e.data;if(n.type==="collectionLoaded"){if(E){E=!1;return}$(n.collection)}if(n.type==="switchTab"){let t=n.tab,l=a("mainTabs").querySelector(`.tab[data-tab="${t}"]`);if(l&&l.click(),n.envName&&c?.config?.environments){let o=c.config.environments.findIndex(d=>d.name===n.envName);o>=0&&M(o)}}});k("mainTabs");a("addDefaultHeaderBtn").addEventListener("click",()=>{x(),r()});a("addDefaultVarBtn").addEventListener("click",()=>{H(),r()});a("defaultAuthType").addEventListener("change",L);a("addEnvBtn").addEventListener("click",V);a("removeEnvBtn").addEventListener("click",B);a("envSelector").addEventListener("change",()=>{let e=parseInt(a("envSelector").value,10);e>=0&&M(e)});["infoName","infoVersion"].forEach(e=>{a(e).addEventListener("input",r)});a("infoSummary").addEventListener("input",r);T.postMessage({type:"ready"});})();
